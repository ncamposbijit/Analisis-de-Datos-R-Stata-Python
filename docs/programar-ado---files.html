<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Programar ado - files | Análisis de Datos con Stata, R y Python</title>
  <meta name="description" content="Libro enfocado en enseñar análisis de datos utilizando Stata, R y Python" />
  <meta name="generator" content="bookdown 0.39.2 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Programar ado - files | Análisis de Datos con Stata, R y Python" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Libro enfocado en enseñar análisis de datos utilizando Stata, R y Python" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Programar ado - files | Análisis de Datos con Stata, R y Python" />
  
  <meta name="twitter:description" content="Libro enfocado en enseñar análisis de datos utilizando Stata, R y Python" />
  

<meta name="author" content="Nicolás Campos Bijit" />


<meta name="date" content="2024-07-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="programar-do---files.html"/>
<link rel="next" href="exportar-información.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html"><i class="fa fa-check"></i><b>2</b> Buenas prácticas de programación</a>
<ul>
<li class="chapter" data-level="2.1" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#programación-defensiva"><i class="fa fa-check"></i><b>2.1</b> Programación defensiva</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#práctica-i-escribir-una-prueba-o-test"><i class="fa fa-check"></i><b>2.1.1</b> Práctica I: escribir una prueba o test</a></li>
<li class="chapter" data-level="2.1.2" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#práctica-ii-no-duplicar-información"><i class="fa fa-check"></i><b>2.1.2</b> Práctica II: no duplicar información</a></li>
<li class="chapter" data-level="2.1.3" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#práctica-iv-estilo-importa"><i class="fa fa-check"></i><b>2.1.3</b> Práctica IV: estilo importa</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#estilo-de-codificación-en-stata"><i class="fa fa-check"></i><b>2.2</b> Estilo de codificación en Stata</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#ser-ordenado-no-es-condición-suficiente-para-tener-un-buen-estilo-de-codificación"><i class="fa fa-check"></i><b>2.2.1</b> Ser ordenado no es condición suficiente para tener un buen estilo de codificación</a></li>
<li class="chapter" data-level="2.2.2" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#escribe-códigos-cortos"><i class="fa fa-check"></i><b>2.2.2</b> Escribe códigos cortos</a></li>
<li class="chapter" data-level="2.2.3" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#el-nombre-de-las-variables-debe-caracterizarla"><i class="fa fa-check"></i><b>2.2.3</b> El nombre de las variables debe caracterizarla</a></li>
<li class="chapter" data-level="2.2.4" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#ten-especial-cuidado-cuando-uses-álgebra-en-los-códigos."><i class="fa fa-check"></i><b>2.2.4</b> Ten especial cuidado cuando uses álgebra en los códigos.</a></li>
<li class="chapter" data-level="2.2.5" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#ser-consistentes"><i class="fa fa-check"></i><b>2.2.5</b> Ser consistentes</a></li>
<li class="chapter" data-level="2.2.6" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#chequear-errores"><i class="fa fa-check"></i><b>2.2.6</b> Chequear errores</a></li>
<li class="chapter" data-level="2.2.7" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#separar-tipos-de-códigos"><i class="fa fa-check"></i><b>2.2.7</b> Separar tipos de códigos</a></li>
<li class="chapter" data-level="2.2.8" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#automatizar-todo-lo-que-se-pueda-automatizar"><i class="fa fa-check"></i><b>2.2.8</b> Automatizar todo lo que se pueda automatizar</a></li>
<li class="chapter" data-level="2.2.9" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#abstraer-para-eliminar-pasos-redundantes."><i class="fa fa-check"></i><b>2.2.9</b> Abstraer para eliminar pasos redundantes.</a></li>
<li class="chapter" data-level="2.2.10" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#crear-códigos-autoexplicativos-que-complementen-a-la-documentación"><i class="fa fa-check"></i><b>2.2.10</b> Crear códigos autoexplicativos que complementen a la documentación</a></li>
<li class="chapter" data-level="2.2.11" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#no-ser-repetitivo"><i class="fa fa-check"></i><b>2.2.11</b> No ser repetitivo</a></li>
<li class="chapter" data-level="2.2.12" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#mensajes-finales-sobre-estilo-de-codificación"><i class="fa fa-check"></i><b>2.2.12</b> Mensajes finales sobre estilo de codificación</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#organización-de-un-proyecto-en-stata"><i class="fa fa-check"></i><b>2.3</b> Organización de un proyecto en Stata</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#flujo-de-trabajo-en-stata"><i class="fa fa-check"></i><b>2.3.1</b> Flujo de trabajo en Stata</a></li>
<li class="chapter" data-level="2.3.2" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#organización-de-archivos-y-carpetas"><i class="fa fa-check"></i><b>2.3.2</b> Organización de archivos y carpetas</a></li>
<li class="chapter" data-level="2.3.3" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#master-do-files"><i class="fa fa-check"></i><b>2.3.3</b> Master <code>do-files</code></a></li>
<li class="chapter" data-level="2.3.4" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#rutas-de-las-carpetas"><i class="fa fa-check"></i><b>2.3.4</b> Rutas de las carpetas:</a></li>
<li class="chapter" data-level="2.3.5" data-path="buenas-prácticas-de-programación.html"><a href="buenas-prácticas-de-programación.html#utilizar-algún-auxiliar-de-generación-de-código-sublime-text"><i class="fa fa-check"></i><b>2.3.5</b> Utilizar algún auxiliar de generación de código: Sublime Text</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="programar-do---files.html"><a href="programar-do---files.html"><i class="fa fa-check"></i><b>3</b> Programar do - files</a>
<ul>
<li class="chapter" data-level="3.1" data-path="programar-do---files.html"><a href="programar-do---files.html#programar-en-stata"><i class="fa fa-check"></i><b>3.1</b> Programar en Stata</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="programar-do---files.html"><a href="programar-do---files.html#comandos-y-funciones-claves-y-algunos-detalles"><i class="fa fa-check"></i><b>3.1.1</b> Comandos y funciones claves (y algunos detalles)}</a></li>
<li class="chapter" data-level="3.1.2" data-path="programar-do---files.html"><a href="programar-do---files.html#macros-locales-y-globales"><i class="fa fa-check"></i><b>3.1.2</b> Macros locales y globales</a></li>
<li class="chapter" data-level="3.1.3" data-path="programar-do---files.html"><a href="programar-do---files.html#estructuras-de-datos"><i class="fa fa-check"></i><b>3.1.3</b> Estructuras de datos</a></li>
<li class="chapter" data-level="3.1.4" data-path="programar-do---files.html"><a href="programar-do---files.html#iteradores"><i class="fa fa-check"></i><b>3.1.4</b> Iteradores</a></li>
<li class="chapter" data-level="3.1.5" data-path="programar-do---files.html"><a href="programar-do---files.html#manejo-de-bases-de-datos"><i class="fa fa-check"></i><b>3.1.5</b> Manejo de bases de datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="programar-ado---files.html"><a href="programar-ado---files.html"><i class="fa fa-check"></i><b>4</b> Programar ado - files</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="programar-ado---files.html"><a href="programar-ado---files.html#escribir-programas-en-stata"><i class="fa fa-check"></i><b>4.0.1</b> Escribir programas en Stata</a></li>
<li class="chapter" data-level="4.0.2" data-path="programar-ado---files.html"><a href="programar-ado---files.html#por-qué-escribir-programas-abstracción"><i class="fa fa-check"></i><b>4.0.2</b> ¿Por qué escribir programas?: Abstracción</a></li>
<li class="chapter" data-level="4.0.3" data-path="programar-ado---files.html"><a href="programar-ado---files.html#mis-primeros-programas-en-stata"><i class="fa fa-check"></i><b>4.0.3</b> Mis primeros programas en Stata</a></li>
<li class="chapter" data-level="4.0.4" data-path="programar-ado---files.html"><a href="programar-ado---files.html#programa-con-distintos-argumentos"><i class="fa fa-check"></i><b>4.0.4</b> Programa con distintos argumentos</a></li>
<li class="chapter" data-level="4.0.5" data-path="programar-ado---files.html"><a href="programar-ado---files.html#opción-syntax"><i class="fa fa-check"></i><b>4.0.5</b> Opción Syntax</a></li>
<li class="chapter" data-level="4.0.6" data-path="programar-ado---files.html"><a href="programar-ado---files.html#return"><i class="fa fa-check"></i><b>4.0.6</b> Return</a></li>
<li class="chapter" data-level="4.0.7" data-path="programar-ado---files.html"><a href="programar-ado---files.html#implementar-opciones-al-programa"><i class="fa fa-check"></i><b>4.0.7</b> Implementar opciones al programa</a></li>
<li class="chapter" data-level="4.0.8" data-path="programar-ado---files.html"><a href="programar-ado---files.html#incluir-ifin-al-programa"><i class="fa fa-check"></i><b>4.0.8</b> Incluir if/in al programa</a></li>
<li class="chapter" data-level="4.0.9" data-path="programar-ado---files.html"><a href="programar-ado---files.html#generalizar-el-comando-para-incluir-múltiples-variables"><i class="fa fa-check"></i><b>4.0.9</b> Generalizar el comando para incluir múltiples variables</a></li>
<li class="chapter" data-level="4.0.10" data-path="programar-ado---files.html"><a href="programar-ado---files.html#agregar-prefijos-a-los-programas"><i class="fa fa-check"></i><b>4.0.10</b> Agregar prefijos a los programas</a></li>
<li class="chapter" data-level="4.0.11" data-path="programar-ado---files.html"><a href="programar-ado---files.html#programas-para-complementar-función-egen"><i class="fa fa-check"></i><b>4.0.11</b> Programas para complementar función egen</a></li>
<li class="chapter" data-level="4.0.12" data-path="programar-ado---files.html"><a href="programar-ado---files.html#syntax"><i class="fa fa-check"></i><b>4.0.12</b> Syntax</a></li>
<li class="chapter" data-level="4.0.13" data-path="programar-ado---files.html"><a href="programar-ado---files.html#varlist"><i class="fa fa-check"></i><b>4.0.13</b> Varlist</a></li>
<li class="chapter" data-level="4.0.14" data-path="programar-ado---files.html"><a href="programar-ado---files.html#opciones"><i class="fa fa-check"></i><b>4.0.14</b> Opciones</a></li>
<li class="chapter" data-level="4.0.15" data-path="programar-ado---files.html"><a href="programar-ado---files.html#programa-para-calcular-percentiles"><i class="fa fa-check"></i><b>4.0.15</b> Programa para calcular percentiles</a></li>
<li class="chapter" data-level="4.0.16" data-path="programar-ado---files.html"><a href="programar-ado---files.html#programa-con-opción-return"><i class="fa fa-check"></i><b>4.0.16</b> Programa con opción return</a></li>
<li class="chapter" data-level="4.0.17" data-path="programar-ado---files.html"><a href="programar-ado---files.html#agregar-opciones-al-programa"><i class="fa fa-check"></i><b>4.0.17</b> Agregar opciones al programa</a></li>
<li class="chapter" data-level="4.0.18" data-path="programar-ado---files.html"><a href="programar-ado---files.html#generalizar-el-comando-para-incluir-múltiples-variables-1"><i class="fa fa-check"></i><b>4.0.18</b> Generalizar el comando para incluir múltiples variables</a></li>
<li class="chapter" data-level="4.0.19" data-path="programar-ado---files.html"><a href="programar-ado---files.html#agregar-prefijos-a-los-programas-1"><i class="fa fa-check"></i><b>4.0.19</b> Agregar prefijos a los programas</a></li>
<li class="chapter" data-level="4.0.20" data-path="programar-ado---files.html"><a href="programar-ado---files.html#programas-para-complementar-función-egen-1"><i class="fa fa-check"></i><b>4.0.20</b> Programas para complementar función egen</a></li>
<li class="chapter" data-level="4.0.21" data-path="programar-ado---files.html"><a href="programar-ado---files.html#generalización-de-la-función-egen"><i class="fa fa-check"></i><b>4.0.21</b> Generalización de la función egen</a></li>
<li class="chapter" data-level="4.0.22" data-path="programar-ado---files.html"><a href="programar-ado---files.html#documentar-tu-programa"><i class="fa fa-check"></i><b>4.0.22</b> Documentar tu programa</a></li>
<li class="chapter" data-level="4.0.23" data-path="programar-ado---files.html"><a href="programar-ado---files.html#escribir-programas-e-class"><i class="fa fa-check"></i><b>4.0.23</b> Escribir programas e-class</a></li>
<li class="chapter" data-level="4.0.24" data-path="programar-ado---files.html"><a href="programar-ado---files.html#marksample-mark-y-markout"><i class="fa fa-check"></i><b>4.0.24</b> Marksample, Mark y Markout</a></li>
<li class="chapter" data-level="4.0.25" data-path="programar-ado---files.html"><a href="programar-ado---files.html#sortpreserve"><i class="fa fa-check"></i><b>4.0.25</b> Sortpreserve</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exportar-información.html"><a href="exportar-información.html"><i class="fa fa-check"></i><b>5</b> Exportar Información</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="exportar-información.html"><a href="exportar-información.html#stata-markdown"><i class="fa fa-check"></i><b>5.0.1</b> Stata Markdown</a></li>
<li class="chapter" data-level="5.0.2" data-path="exportar-información.html"><a href="exportar-información.html#putdocx"><i class="fa fa-check"></i><b>5.0.2</b> Putdocx</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html"><i class="fa fa-check"></i><b>6</b> Manejo de grandes bases de datos en Stata</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#estilo-de-codificación-mejorar-velocidad-y-eficiencia"><i class="fa fa-check"></i><b>6.0.1</b> Estilo de codificación: mejorar velocidad y eficiencia</a></li>
<li class="chapter" data-level="6.0.2" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#cargar-grandes-bases-de-datos"><i class="fa fa-check"></i><b>6.0.2</b> Cargar grandes bases de datos</a></li>
<li class="chapter" data-level="6.0.3" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#reducir-el-uso-de-memoria"><i class="fa fa-check"></i><b>6.0.3</b> Reducir el uso de memoria</a></li>
<li class="chapter" data-level="6.0.4" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#reducir-el-tamaño-de-la-base-de-datos"><i class="fa fa-check"></i><b>6.0.4</b> Reducir el tamaño de la base de datos</a></li>
<li class="chapter" data-level="6.0.5" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#eliminar-siempre-resultados-intermedios-incluso-temporales"><i class="fa fa-check"></i><b>6.0.5</b> Eliminar siempre resultados intermedios, incluso temporales</a></li>
<li class="chapter" data-level="6.0.6" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#dividir-en-trozos-cuando-sea-posible"><i class="fa fa-check"></i><b>6.0.6</b> Dividir en trozos cuando sea posible</a></li>
<li class="chapter" data-level="6.0.7" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#sort"><i class="fa fa-check"></i><b>6.0.7</b> Sort</a></li>
<li class="chapter" data-level="6.0.8" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#selección-de-muestra"><i class="fa fa-check"></i><b>6.0.8</b> Selección de muestra</a></li>
<li class="chapter" data-level="6.0.9" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#precaución-con-reshape"><i class="fa fa-check"></i><b>6.0.9</b> Precaución con reshape</a></li>
<li class="chapter" data-level="6.0.10" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#subexpresiones-comunes"><i class="fa fa-check"></i><b>6.0.10</b> Subexpresiones comunes</a></li>
<li class="chapter" data-level="6.0.11" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#recomendaciones-adicionales"><i class="fa fa-check"></i><b>6.0.11</b> Recomendaciones Adicionales</a></li>
<li class="chapter" data-level="6.0.12" data-path="manejo-de-grandes-bases-de-datos-en-stata.html"><a href="manejo-de-grandes-bases-de-datos-en-stata.html#resumen"><i class="fa fa-check"></i><b>6.0.12</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mata.html"><a href="mata.html"><i class="fa fa-check"></i><b>7</b> Mata</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mata.html"><a href="mata.html#qué-es-mata"><i class="fa fa-check"></i><b>7.1</b> ¿Qué es Mata?</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="programar-do---files-1.html"><a href="programar-do---files-1.html"><i class="fa fa-check"></i><b>8</b> Programar do - files</a>
<ul>
<li class="chapter" data-level="8.1" data-path="programar-do---files-1.html"><a href="programar-do---files-1.html#programar-en-stata-1"><i class="fa fa-check"></i><b>8.1</b> Programar en Stata</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="programar-do---files-1.html"><a href="programar-do---files-1.html#comandos-y-funciones-claves-y-algunos-detalles-1"><i class="fa fa-check"></i><b>8.1.1</b> Comandos y funciones claves (y algunos detalles)}</a></li>
<li class="chapter" data-level="8.1.2" data-path="programar-do---files-1.html"><a href="programar-do---files-1.html#macros-locales-y-globales-1"><i class="fa fa-check"></i><b>8.1.2</b> Macros locales y globales</a></li>
<li class="chapter" data-level="8.1.3" data-path="programar-do---files-1.html"><a href="programar-do---files-1.html#estructuras-de-datos-1"><i class="fa fa-check"></i><b>8.1.3</b> Estructuras de datos</a></li>
<li class="chapter" data-level="8.1.4" data-path="programar-do---files-1.html"><a href="programar-do---files-1.html#iteradores-1"><i class="fa fa-check"></i><b>8.1.4</b> Iteradores</a></li>
<li class="chapter" data-level="8.1.5" data-path="programar-do---files-1.html"><a href="programar-do---files-1.html#manejo-de-bases-de-datos-1"><i class="fa fa-check"></i><b>8.1.5</b> Manejo de bases de datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html"><i class="fa fa-check"></i><b>9</b> Análisis de Datos con Python</a>
<ul>
<li class="chapter" data-level="9.1" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#introducción-al-análisis-de-datos-con-python"><i class="fa fa-check"></i><b>9.1</b> Introducción al análisis de datos con Python</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#antes-de-partir-con-python"><i class="fa fa-check"></i><b>9.1.1</b> Antes de partir con Python…</a></li>
<li class="chapter" data-level="9.1.2" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#atajos"><i class="fa fa-check"></i><b>9.1.2</b> Atajos</a></li>
<li class="chapter" data-level="9.1.3" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#extensiones-de-jupyter-notebook"><i class="fa fa-check"></i><b>9.1.3</b> Extensiones de Jupyter Notebook</a></li>
<li class="chapter" data-level="9.1.4" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#sintaxis-básica"><i class="fa fa-check"></i><b>9.1.4</b> Sintaxis básica</a></li>
<li class="chapter" data-level="9.1.5" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#variables-y-objetos"><i class="fa fa-check"></i><b>9.1.5</b> Variables y objetos</a></li>
<li class="chapter" data-level="9.1.6" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#operadores"><i class="fa fa-check"></i><b>9.1.6</b> Operadores</a></li>
<li class="chapter" data-level="9.1.7" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#estructuras-de-datos-listas-tuplas-conjuntos-diccionarios"><i class="fa fa-check"></i><b>9.1.7</b> Estructuras de datos: listas, tuplas, conjuntos, diccionarios</a></li>
<li class="chapter" data-level="9.1.8" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#funciones-2"><i class="fa fa-check"></i><b>9.1.8</b> Funciones</a></li>
<li class="chapter" data-level="9.1.9" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#methods"><i class="fa fa-check"></i><b>9.1.9</b> Methods</a></li>
<li class="chapter" data-level="9.1.10" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#paquetes"><i class="fa fa-check"></i><b>9.1.10</b> Paquetes</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#librerias-principales-de-python---numpy-matplotlib-pandas"><i class="fa fa-check"></i><b>9.2</b> Librerías principales de Python - Numpy, Matplotlib, Pandas</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#numpy"><i class="fa fa-check"></i><b>9.2.1</b> NumPy</a></li>
<li class="chapter" data-level="9.2.2" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#matplotlib"><i class="fa fa-check"></i><b>9.2.2</b> Matplotlib</a></li>
<li class="chapter" data-level="9.2.3" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#pandas"><i class="fa fa-check"></i><b>9.2.3</b> Pandas</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#herramientas-de-programación"><i class="fa fa-check"></i><b>9.3</b> Herramientas de programación</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#controladores-de-flujo"><i class="fa fa-check"></i><b>9.3.1</b> Controladores de flujo</a></li>
<li class="chapter" data-level="9.3.2" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#if-elif-else"><i class="fa fa-check"></i><b>9.3.2</b> if-elif-else</a></li>
<li class="chapter" data-level="9.3.3" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#iteradores-básicos"><i class="fa fa-check"></i><b>9.3.3</b> Iteradores básicos</a></li>
<li class="chapter" data-level="9.3.4" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#iteradores-adicionales-en-python"><i class="fa fa-check"></i><b>9.3.4</b> Iteradores adicionales en Python</a></li>
<li class="chapter" data-level="9.3.5" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#list-comprehension"><i class="fa fa-check"></i><b>9.3.5</b> List Comprehension</a></li>
<li class="chapter" data-level="9.3.6" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#generadores"><i class="fa fa-check"></i><b>9.3.6</b> Generadores</a></li>
<li class="chapter" data-level="9.3.7" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#funciones-3"><i class="fa fa-check"></i><b>9.3.7</b> Funciones</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#manipulación-de-bases-de-datos-parte-i"><i class="fa fa-check"></i><b>9.4</b> Manipulación de bases de datos (Parte I)</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#importar-e-inspeccionar-datos-repaso"><i class="fa fa-check"></i><b>9.4.1</b> Importar e inspeccionar datos (repaso)</a></li>
<li class="chapter" data-level="9.4.2" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#manipular-repaso"><i class="fa fa-check"></i><b>9.4.2</b> Manipular (repaso)</a></li>
<li class="chapter" data-level="9.4.3" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#agrupar-calculos"><i class="fa fa-check"></i><b>9.4.3</b> Agrupar calculos</a></li>
<li class="chapter" data-level="9.4.4" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#aplicar-funciones"><i class="fa fa-check"></i><b>9.4.4</b> Aplicar funciones</a></li>
<li class="chapter" data-level="9.4.5" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#datos-como-tablas-problemas-y-soluciones"><i class="fa fa-check"></i><b>9.4.5</b> Datos como tablas: problemas y soluciones</a></li>
<li class="chapter" data-level="9.4.6" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#concatenar-data-frames"><i class="fa fa-check"></i><b>9.4.6</b> Concatenar data frames</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#manipulación-de-bases-de-datos-parte-ii"><i class="fa fa-check"></i><b>9.5</b> Manipulación de bases de datos (Parte II)</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#aplicar-funciones-a-columnas-de-una-base-de-datos"><i class="fa fa-check"></i><b>9.5.1</b> Aplicar funciones a columnas de una base de datos</a></li>
<li class="chapter" data-level="9.5.2" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#dividir-una-base-de-datos-por-grupos"><i class="fa fa-check"></i><b>9.5.2</b> Dividir una base de datos por grupos</a></li>
<li class="chapter" data-level="9.5.3" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#librería-datetime"><i class="fa fa-check"></i><b>9.5.3</b> Librería datetime</a></li>
<li class="chapter" data-level="9.5.4" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#reestructurar-un-dataframe"><i class="fa fa-check"></i><b>9.5.4</b> Reestructurar un DataFrame</a></li>
<li class="chapter" data-level="9.5.5" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#reestructurar-datos-para-arreglar-posibles-problemas"><i class="fa fa-check"></i><b>9.5.5</b> Reestructurar datos para arreglar posibles problemas</a></li>
<li class="chapter" data-level="9.5.6" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#missing-values-2"><i class="fa fa-check"></i><b>9.5.6</b> Missing values</a></li>
<li class="chapter" data-level="9.5.7" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#juntar-bases-de-datos-merge-y-append"><i class="fa fa-check"></i><b>9.5.7</b> Juntar bases de datos: merge y append</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#análisis-de-datos-parte-i"><i class="fa fa-check"></i><b>9.6</b> Análisis de datos (Parte I)</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#estadistica-descriptiva"><i class="fa fa-check"></i><b>9.6.1</b> Estadistica Descriptiva</a></li>
<li class="chapter" data-level="9.6.2" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#la-distribución-normal"><i class="fa fa-check"></i><b>9.6.2</b> La distribución normal</a></li>
<li class="chapter" data-level="9.6.3" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#test-de-hipotesis"><i class="fa fa-check"></i><b>9.6.3</b> Test de hipotesis</a></li>
<li class="chapter" data-level="9.6.4" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#ejemplo-1-resumen-exploratorio-de-datos"><i class="fa fa-check"></i><b>9.6.4</b> Ejemplo 1: resumen exploratorio de datos</a></li>
<li class="chapter" data-level="9.6.5" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#ejemplo-2-datos-con-precios-de-casas"><i class="fa fa-check"></i><b>9.6.5</b> Ejemplo 2: datos con precios de casas</a></li>
<li class="chapter" data-level="9.6.6" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#ejemplo-3"><i class="fa fa-check"></i><b>9.6.6</b> Ejemplo 3</a></li>
<li class="chapter" data-level="9.6.7" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#ejemplo-4"><i class="fa fa-check"></i><b>9.6.7</b> Ejemplo 4</a></li>
<li class="chapter" data-level="9.6.8" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#ejemplo-5-desigualdad-de-ingreso-usando-gapminder"><i class="fa fa-check"></i><b>9.6.8</b> Ejemplo 5 : Desigualdad de ingreso usando Gapminder</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#análisis-de-datos-parte-ii"><i class="fa fa-check"></i><b>9.7</b> Análisis de datos (Parte II)</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#optimización-con-scipy"><i class="fa fa-check"></i><b>9.7.1</b> Optimización con Scipy</a></li>
<li class="chapter" data-level="9.7.2" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#modelo-de-regresión-lineal"><i class="fa fa-check"></i><b>9.7.2</b> Modelo de regresión lineal</a></li>
<li class="chapter" data-level="9.7.3" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#una-simulación-de-montecarlo"><i class="fa fa-check"></i><b>9.7.3</b> Una simulación de montecarlo</a></li>
<li class="chapter" data-level="9.7.4" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#bootstraping"><i class="fa fa-check"></i><b>9.7.4</b> Bootstraping</a></li>
<li class="chapter" data-level="9.7.5" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#regresión-logistica"><i class="fa fa-check"></i><b>9.7.5</b> Regresión Logistica</a></li>
<li class="chapter" data-level="9.7.6" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#matching"><i class="fa fa-check"></i><b>9.7.6</b> Matching</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#análisis-de-datos-parte-iii"><i class="fa fa-check"></i><b>9.8</b> Análisis de Datos (Parte III)</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#bootstraping-en-el-contexto-de-mco"><i class="fa fa-check"></i><b>9.8.1</b> Bootstraping en el contexto de MCO</a></li>
<li class="chapter" data-level="9.8.2" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#logit-probabilidad-de-sobrevivir-al-hundimiento-del-titanic"><i class="fa fa-check"></i><b>9.8.2</b> Logit: Probabilidad de sobrevivir al hundimiento del Titanic</a></li>
<li class="chapter" data-level="9.8.3" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#gmm"><i class="fa fa-check"></i><b>9.8.3</b> GMM</a></li>
<li class="chapter" data-level="9.8.4" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#diferencias-en-diferencias"><i class="fa fa-check"></i><b>9.8.4</b> Diferencias en Diferencias</a></li>
<li class="chapter" data-level="9.8.5" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#plotly"><i class="fa fa-check"></i><b>9.8.5</b> Plotly</a></li>
<li class="chapter" data-level="9.8.6" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#automatización"><i class="fa fa-check"></i><b>9.8.6</b> Automatización</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#web-scraping-en-python"><i class="fa fa-check"></i><b>9.9</b> Web Scraping en Python</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#introducción-3"><i class="fa fa-check"></i><b>9.9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.9.2" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#muchos-ejemplos-practicos-de-web---scraping"><i class="fa fa-check"></i><b>9.9.2</b> Muchos ejemplos practicos de Web - scraping</a></li>
<li class="chapter" data-level="9.9.3" data-path="análisis-de-datos-con-python.html"><a href="análisis-de-datos-con-python.html#selenium"><i class="fa fa-check"></i><b>9.9.3</b> Selenium</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html"><i class="fa fa-check"></i><b>10</b> Análisis de datos con R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#introducción-a-r-y-rstudio"><i class="fa fa-check"></i><b>10.1</b> Introducción a R y RStudio</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#por-qué-utilizar-r-como-lenguaje-de-programación"><i class="fa fa-check"></i><b>10.1.1</b> ¿Por qué utilizar R como lenguaje de programación?</a></li>
<li class="chapter" data-level="10.1.2" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#términos-clave-y-recurrentes-a-lo-largo-del-curso"><i class="fa fa-check"></i><b>10.1.2</b> Términos clave y recurrentes a lo largo del curso</a></li>
<li class="chapter" data-level="10.1.3" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#recursos-de-aprendizaje"><i class="fa fa-check"></i><b>10.1.3</b> Recursos de Aprendizaje</a></li>
<li class="chapter" data-level="10.1.4" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#interfaz-rstudio"><i class="fa fa-check"></i><b>10.1.4</b> Interfaz RStudio</a></li>
<li class="chapter" data-level="10.1.5" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#instalación-de-paquetes-y-ayuda"><i class="fa fa-check"></i><b>10.1.5</b> Instalación de paquetes y ayuda</a></li>
<li class="chapter" data-level="10.1.6" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#manipulación-de-objetos"><i class="fa fa-check"></i><b>10.1.6</b> Manipulación de objetos</a></li>
<li class="chapter" data-level="10.1.7" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#tipos-de-objetos"><i class="fa fa-check"></i><b>10.1.7</b> Tipos de objetos</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#herramientas-de-programación-1"><i class="fa fa-check"></i><b>10.2</b> Herramientas de programación</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#objetos-adicionales"><i class="fa fa-check"></i><b>10.2.1</b> Objetos adicionales</a></li>
<li class="chapter" data-level="10.2.2" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#acceder-a-elementos-de-un-objeto"><i class="fa fa-check"></i><b>10.2.2</b> Acceder a elementos de un objeto</a></li>
<li class="chapter" data-level="10.2.3" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#tipos-de-objetos-y-datos"><i class="fa fa-check"></i><b>10.2.3</b> Tipos de objetos y datos</a></li>
<li class="chapter" data-level="10.2.4" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#herramientas-en-r"><i class="fa fa-check"></i><b>10.2.4</b> Herramientas en R</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#manipulación-de-bases-de-datos-parte-i-1"><i class="fa fa-check"></i><b>10.3</b> Manipulación de bases de datos (Parte I)</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#principios-de-programación"><i class="fa fa-check"></i><b>10.3.1</b> Principios de programación</a></li>
<li class="chapter" data-level="10.3.2" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#manipulacion-de-bases-de-datos-en-r"><i class="fa fa-check"></i><b>10.3.2</b> Manipulacion de bases de datos en R</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#manipulación-de-bases-de-datos-parte-ii-1"><i class="fa fa-check"></i><b>10.4</b> Manipulación de bases de datos (Parte II)</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#funciones-clave"><i class="fa fa-check"></i><b>10.4.1</b> Funciones clave</a></li>
<li class="chapter" data-level="10.4.2" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#operador-piping"><i class="fa fa-check"></i><b>10.4.2</b> Operador piping</a></li>
<li class="chapter" data-level="10.4.3" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#proceso-de-análisis-de-datos-parte-i-cargar-inspeccionar-y-limpiar"><i class="fa fa-check"></i><b>10.4.3</b> Proceso de análisis de datos (Parte I): cargar, inspeccionar y limpiar</a></li>
<li class="chapter" data-level="10.4.4" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#proceso-de-análisis-de-datos-parte-ii-cargar-inspeccionar-y-limpiar"><i class="fa fa-check"></i><b>10.4.4</b> Proceso de análisis de datos (Parte II): cargar, inspeccionar y limpiar</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#manipulación-de-bases-de-datos-parte-iii"><i class="fa fa-check"></i><b>10.5</b> Manipulación de bases de datos (Parte III)</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#crear-variables"><i class="fa fa-check"></i><b>10.5.1</b> Crear Variables</a></li>
<li class="chapter" data-level="10.5.2" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#factores"><i class="fa fa-check"></i><b>10.5.2</b> Factores</a></li>
<li class="chapter" data-level="10.5.3" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#funciones-útiles-para-transformar-bases-de-datos"><i class="fa fa-check"></i><b>10.5.3</b> Funciones útiles para transformar bases de datos</a></li>
<li class="chapter" data-level="10.5.4" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#cambio-de-formato-de-los-datos"><i class="fa fa-check"></i><b>10.5.4</b> Cambio de formato de los datos</a></li>
<li class="chapter" data-level="10.5.5" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#juntar-bases-de-datos"><i class="fa fa-check"></i><b>10.5.5</b> Juntar bases de datos</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#análisis-de-datos"><i class="fa fa-check"></i><b>10.6</b> Análisis de datos</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#inspección-de-datos"><i class="fa fa-check"></i><b>10.6.1</b> Inspección de datos</a></li>
<li class="chapter" data-level="10.6.2" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#estadística-descriptiva"><i class="fa fa-check"></i><b>10.6.2</b> Estadística descriptiva</a></li>
<li class="chapter" data-level="10.6.3" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#tablas-de-frecuencia"><i class="fa fa-check"></i><b>10.6.3</b> Tablas de frecuencia</a></li>
<li class="chapter" data-level="10.6.4" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#estadística-descriptiva-con-dplyr"><i class="fa fa-check"></i><b>10.6.4</b> Estadística descriptiva con “dplyr”</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#visualización"><i class="fa fa-check"></i><b>10.7</b> Visualización</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#visualización-r-base"><i class="fa fa-check"></i><b>10.7.1</b> Visualización: R base</a></li>
<li class="chapter" data-level="10.7.2" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#uso-paquete-ggplot"><i class="fa fa-check"></i><b>10.7.2</b> Uso paquete ggplot</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#análisis-de-datos-y-generación-de-informes-con-r-markdown"><i class="fa fa-check"></i><b>10.8</b> Análisis de datos y generación de informes con R Markdown</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#test-de-hipótesis"><i class="fa fa-check"></i><b>10.8.1</b> Test de hipótesis</a></li>
<li class="chapter" data-level="10.8.2" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#regresión-lineal-en-r"><i class="fa fa-check"></i><b>10.8.2</b> Regresión Lineal en R</a></li>
<li class="chapter" data-level="10.8.3" data-path="análisis-de-datos-con-r.html"><a href="análisis-de-datos-con-r.html#r-markdown"><i class="fa fa-check"></i><b>10.8.3</b> R Markdown</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis de Datos con Stata, R y Python</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="programar-ado---files" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Programar ado - files<a href="programar-ado---files.html#programar-ado---files" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="escribir-programas-en-stata" class="section level3 hasAnchor" number="4.0.1">
<h3><span class="header-section-number">4.0.1</span> Escribir programas en Stata<a href="programar-ado---files.html#escribir-programas-en-stata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En esta sección aprenderemos a escribir nuestros propios comandos en Stata. Escribir programas en Stata tiene muchas ventajas relacionadas con las buenas practicas que vimos en la Sección 1.</p>
<p>Vamos a utilizar <code>program</code> para escribir los programas. Es posible equipar cualquier comando con las opciones típicas usuales (ej. <code>if</code> o <code>inrange</code>. Discutiremos mayormente programas del tipo <code>r-class</code> y algunos comentarios con respecto a los del tipo <code>e-class</code>.</p>
<p><strong>¿Por qué debiese escribir mis propios programas en Stata?</strong> Automatizar procesos que se ejecutan frecuentemente y donde los resultados dependen de algún tipo de heterogeneidad.</p>
</div>
<div id="por-qué-escribir-programas-abstracción" class="section level3 hasAnchor" number="4.0.2">
<h3><span class="header-section-number">4.0.2</span> ¿Por qué escribir programas?: Abstracción<a href="programar-ado---files.html#por-qué-escribir-programas-abstracción" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Abstraer para eliminar pasos redundantes.<br />
</li>
<li>Abstraer con fines de hacer códigos más claros. <strong>No por otras razones</strong>.</li>
<li>Abstracción es esencial para escribir un buen código por al menos dos razones:
<ul>
<li>Al eliminar la redundancia se reducen las posibilidades de cometer errores.</li>
<li>Aumenta la claridad. Para cualquier lector será más facil leer un código no redundante.</li>
</ul></li>
</ul>
<p>Veamos un ejemplo: Supongamos que queremos ver la correlación espacial del consumo de papas fritas. Queremos testear si el consumo per-capita de papas fritas esta correlacionado con el consumo promedio percapita de las otras comunas de la misma región. Primero tenemos que calcular el consumo per-capita del resto:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb116-1"><a href="programar-ado---files.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> total_pc_papitas = <span class="kw">total</span>(pc_papitas), <span class="kw">by</span>(region)</span>
<span id="cb116-2"><a href="programar-ado---files.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> total_obs = <span class="fu">count</span>(pc_papitas), <span class="kw">by</span>(region)</span>
<span id="cb116-3"><a href="programar-ado---files.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> consumo_papitas_resto_pc = <span class="co">///</span></span>
<span id="cb116-4"><a href="programar-ado---files.html#cb116-4" aria-hidden="true" tabindex="-1"></a>(total_pc_papitas - pc_papitas)/(total_obs - 1)</span></code></pre></div>
<p>Ahora podemos ver si existe correlación. ¿Pero si queremos cambiar el nivel de agregación? Tal vez si existe correlación, pero a nivel de área metropolitana. Copiemos el código de nuevo y calculemos esto.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb117-1"><a href="programar-ado---files.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> total_pc_papitas = <span class="kw">total</span>(pc_papitas), <span class="kw">by</span>(metroarea)</span>
<span id="cb117-2"><a href="programar-ado---files.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> total_obs = <span class="fu">count</span>(pc_papitas), <span class="kw">by</span>(region)</span>
<span id="cb117-3"><a href="programar-ado---files.html#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> consumo_papitas_restometro_pc = <span class="co">///</span></span>
<span id="cb117-4"><a href="programar-ado---files.html#cb117-4" aria-hidden="true" tabindex="-1"></a>(total_pc_papitas - pc_papitas)/(total_obs - 1)</span></code></pre></div>
<p>Noten que hay un error. Se nos olvido remplazar región por <code>metroarea</code>. Este error se puede propagar si seguimos haciendo operaciones. Una alternativa al copiar y pegar es escribir una función con propósito general que calcule la variable que deseamos bajo distintos parámetros.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb118-1"><a href="programar-ado---files.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> consumo_papitas_resto </span>
<span id="cb118-2"><a href="programar-ado---files.html#cb118-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span>, invar(varname) outvar(<span class="bn">name</span>) byvar(varname)</span>
<span id="cb118-3"><a href="programar-ado---files.html#cb118-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempvar</span> tot_invar count_invar </span>
<span id="cb118-4"><a href="programar-ado---files.html#cb118-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">egen</span> <span class="ot">`tot_invar&#39;</span> = <span class="kw">total</span>(<span class="ot">`invar&#39;</span>), <span class="kw">by</span>(<span class="ot">`byvar&#39;</span>)</span>
<span id="cb118-5"><a href="programar-ado---files.html#cb118-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">egen</span> <span class="ot">`count_invar&#39;</span> = <span class="fu">count</span>(&#39;invar&#39;), <span class="kw">by</span>(&#39;byvar&#39;) </span>
<span id="cb118-6"><a href="programar-ado---files.html#cb118-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">gen</span> <span class="ot">`outvar&#39;</span> = (<span class="ot">`tot_invar&#39;</span> - <span class="ot">`invar&#39;</span>) <span class="co">///</span></span>
<span id="cb118-7"><a href="programar-ado---files.html#cb118-7" aria-hidden="true" tabindex="-1"></a>    / (<span class="ot">`count_invar&#39;</span> - 1) </span>
<span id="cb118-8"><a href="programar-ado---files.html#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
<p>Con el programa podemos escribir los bloques de código anteriores como:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb119-1"><a href="programar-ado---files.html#cb119-1" aria-hidden="true" tabindex="-1"></a>* Caso 1 </span>
<span id="cb119-2"><a href="programar-ado---files.html#cb119-2" aria-hidden="true" tabindex="-1"></a>consumo_papitas_resto, invar(pc_papitas) <span class="co">///</span></span>
<span id="cb119-3"><a href="programar-ado---files.html#cb119-3" aria-hidden="true" tabindex="-1"></a>outvar(consumo_papitas_resto_pc) byvar(region)</span>
<span id="cb119-4"><a href="programar-ado---files.html#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="programar-ado---files.html#cb119-5" aria-hidden="true" tabindex="-1"></a>* Caso 2</span>
<span id="cb119-6"><a href="programar-ado---files.html#cb119-6" aria-hidden="true" tabindex="-1"></a>consumo_papitas_resto, invar(pc_papitas)  <span class="co">///</span></span>
<span id="cb119-7"><a href="programar-ado---files.html#cb119-7" aria-hidden="true" tabindex="-1"></a>outvar(consumo_papitas_restometro_pc) byvar(metroarea)</span></code></pre></div>
<p>Hemos escrito la función de forma totalmente general. Podemos cambiar el nivel de agregación sin inducir errores.</p>
<p>Estructura de un programa en Stata: La sintaxis más simple es:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb120-1"><a href="programar-ado---files.html#cb120-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">program</span> nombredelprograma</span>
<span id="cb120-2"><a href="programar-ado---files.html#cb120-2" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="st">&quot;Lo que va a hacer el programa&quot;</span></span>
<span id="cb120-3"><a href="programar-ado---files.html#cb120-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span> </span></code></pre></div>
<p>Cuando se ha definido un programa con <code>program</code>, este se vuelve indistinguible de cualquier otro comando de Stata. Es importante estar seguros(as) de que no estoy escribiendo el mismo nombre que otro programa. Para garantizar lo anterior, es bueno utilizar el comando <code>which</code>.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb121-1"><a href="programar-ado---files.html#cb121-1" aria-hidden="true" tabindex="-1"></a>which tabmiss</span></code></pre></div>
<p>Guardar un programa en Stata</p>
<ul>
<li>Hay dos lugares en donde puedes guardar tus <code>ado-files</code>.</li>
<li>Cuando se ha definido un programa con <code>program</code>, este se vuelve indistinguible de cualquier otro comando de Stata.</li>
<li>En el directorio de trabajo del proyecto.</li>
<li>Se puede hacer una carpeta nueva en la sección de códigos que indique los programas.</li>
<li>Otra opción es guardarlo en el directorio <code>Personal</code> de Stata. Para entrar escriban <code>personal</code> en la consola.</li>
</ul>
<p>Nombrar un programa en Stata</p>
<ul>
<li>Es posible darle cualquier nombre a un programa mientras no sea un nombre que ya es utilizado por Stata.</li>
<li>Si por ejemplo, creas un programa llamado <code>summarize</code> Stata lo va a ignorar y utilizará su propio comando.</li>
</ul>
</div>
<div id="mis-primeros-programas-en-stata" class="section level3 hasAnchor" number="4.0.3">
<h3><span class="header-section-number">4.0.3</span> Mis primeros programas en Stata<a href="programar-ado---files.html#mis-primeros-programas-en-stata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="programa-1" class="section level4 hasAnchor" number="4.0.3.1">
<h4><span class="header-section-number">4.0.3.1</span> Programa 1<a href="programar-ado---files.html#programa-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Vamos escribir nuestro primer programa:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb122-1"><a href="programar-ado---files.html#cb122-1" aria-hidden="true" tabindex="-1"></a>  * Mi primer programa en Stata</span>
<span id="cb122-2"><a href="programar-ado---files.html#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">program</span> minombrees </span>
<span id="cb122-3"><a href="programar-ado---files.html#cb122-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="st">&quot;Hola, mi nombre es &quot;</span></span>
<span id="cb122-4"><a href="programar-ado---files.html#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span> </span></code></pre></div>
<p>Noten que al ejecutarlo no se genera ningún resultado. Lo que hemos hecho es definir un comando llamado <code>minombrees</code> con una simple función. Esta es la idea principal de un programa. Ejecuten nuevamente el programa. Al hacer esto observaran que se genera un error. Esto es porque al igual que las variables, no es posible asignar dos nombres iguales a un programa. Para evitar esto, es importante utilizar <code>program drop minombrees</code> antes de cargar el comando nuevamente. Este es un buen momento para utilizar <code>capture</code>.</p>
</div>
<div id="programa-2" class="section level4 hasAnchor" number="4.0.3.2">
<h4><span class="header-section-number">4.0.3.2</span> Programa 2<a href="programar-ado---files.html#programa-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Vamos escribir un programa que permita calcular un promedio. Vamos a escribir un comando que nos permita crear una nueva variable que contenga los valores promedio y que muestre el resultado en la pantalla. Esto sería igual que escribir:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb123-1"><a href="programar-ado---files.html#cb123-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">sysuse</span> auto, <span class="kw">clear</span></span>
<span id="cb123-2"><a href="programar-ado---files.html#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">egen</span> mimedia_mpg = <span class="kw">mean</span>(mpg)</span>
<span id="cb123-3"><a href="programar-ado---files.html#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> mean_mpg </span></code></pre></div>
<p>Podemos evitar la repetición de estos dos comandos armando un programa:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb124-1"><a href="programar-ado---files.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span> </span>
<span id="cb124-2"><a href="programar-ado---files.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> <span class="kw">program</span> <span class="kw">drop</span> mymean</span>
<span id="cb124-3"><a href="programar-ado---files.html#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> mymean </span>
<span id="cb124-4"><a href="programar-ado---files.html#cb124-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">egen</span> media_<span class="ot">`1&#39;</span> = <span class="kw">mean</span>(<span class="ot">`1&#39;</span>)</span>
<span id="cb124-5"><a href="programar-ado---files.html#cb124-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> media_<span class="ot">`1&#39;</span></span>
<span id="cb124-6"><a href="programar-ado---files.html#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span>
<span id="cb124-7"><a href="programar-ado---files.html#cb124-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-8"><a href="programar-ado---files.html#cb124-8" aria-hidden="true" tabindex="-1"></a>* Aplicamos este programa </span>
<span id="cb124-9"><a href="programar-ado---files.html#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="kw">sysuse</span> auto, <span class="kw">clear</span></span>
<span id="cb124-10"><a href="programar-ado---files.html#cb124-10" aria-hidden="true" tabindex="-1"></a>mimedia mpg</span></code></pre></div>
<p>Noten que hemos utilizado `<code>1'</code>. Este nos indica cualquier variable que este en la primera posición. Si incluimos más de una variable. <strong>Solo va a considerar la primera variable</strong>.</p>
<div class="alert alert-block alert-warning">
<p><b>Ejercicio 3.5.1: </b></p>
<p>Preguntas</p>
<ol style="list-style-type: decimal">
<li>Escriba un programa que permita ver todas las etiquetas (<code>labels</code>) de una base de datos.</li>
<li>Aplique este programa a la base <code>auto.dta</code>.</li>
</ol>
</div>
</div>
<div id="programa-3" class="section level4 hasAnchor" number="4.0.3.3">
<h4><span class="header-section-number">4.0.3.3</span> Programa 3<a href="programar-ado---files.html#programa-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Vamos a reescribir el programa para permitir un número arbitrario de variables. La macro ‘0’ contiene toda la cadena, ‘1’ el primer elemento, ‘2’ el segundo, etc. Podemos hacer una iteración sobre todos los elementos sin saber cuántos hay utilizando la técnica de desplazamiento incremental que implementaremos con <code>macro_shift</code>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb125-1"><a href="programar-ado---files.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> <span class="kw">program</span> <span class="kw">drop</span> mimedia </span>
<span id="cb125-2"><a href="programar-ado---files.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">define</span> mimedia </span>
<span id="cb125-3"><a href="programar-ado---files.html#cb125-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">while</span> <span class="st">&quot;`1&#39;&quot;</span>!=<span class="st">&quot;&quot;</span> { </span>
<span id="cb125-4"><a href="programar-ado---files.html#cb125-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">egen</span> mean_<span class="ot">`1&#39;</span>=<span class="kw">mean</span>(<span class="ot">`1&#39;</span>) </span>
<span id="cb125-5"><a href="programar-ado---files.html#cb125-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">tab</span> mean_<span class="ot">`1&#39;</span> </span>
<span id="cb125-6"><a href="programar-ado---files.html#cb125-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">macro</span> <span class="kw">shift</span></span>
<span id="cb125-7"><a href="programar-ado---files.html#cb125-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb125-8"><a href="programar-ado---files.html#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb125-9"><a href="programar-ado---files.html#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="programar-ado---files.html#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="kw">sysuse</span> auto, <span class="kw">clear</span></span>
<span id="cb125-11"><a href="programar-ado---files.html#cb125-11" aria-hidden="true" tabindex="-1"></a>mimedia price mpg rep78 </span></code></pre></div>
<p>El comando <code>macro shift</code> sirve como incremental. Termina cuando encuentra un vacio, lo que explica la presencia del <code>while</code>. Notar que <code>"</code>1’“` habla de la posición. Es una buena tecnica para garantizar que el iterador seguirá cuando este vacio.</p>
</div>
<div id="programa-4" class="section level4 hasAnchor" number="4.0.3.4">
<h4><span class="header-section-number">4.0.3.4</span> Programa 4<a href="programar-ado---files.html#programa-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Modificamos un poco el programa para que despliegue los resultados en la consola de Stata. Adicionalmente, agregamos un <code>quietly</code>.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb126-1"><a href="programar-ado---files.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> <span class="kw">program</span> <span class="kw">drop</span> mimedia </span>
<span id="cb126-2"><a href="programar-ado---files.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">define</span> mimedia </span>
<span id="cb126-3"><a href="programar-ado---files.html#cb126-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">while</span> <span class="st">&quot;`1&#39;&quot;</span>!=<span class="st">&quot;&quot;</span> { </span>
<span id="cb126-4"><a href="programar-ado---files.html#cb126-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">qui</span>: <span class="kw">egen</span> <span class="ot">`1&#39;</span>_mean = <span class="kw">mean</span>(<span class="ot">`1&#39;</span>) </span>
<span id="cb126-5"><a href="programar-ado---files.html#cb126-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="st">&quot;Media de `1&#39; = &quot;</span> <span class="ot">`1&#39;</span>_mean </span>
<span id="cb126-6"><a href="programar-ado---files.html#cb126-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">macro</span> <span class="kw">shift</span></span>
<span id="cb126-7"><a href="programar-ado---files.html#cb126-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb126-8"><a href="programar-ado---files.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb126-9"><a href="programar-ado---files.html#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="programar-ado---files.html#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="kw">sysuse</span> auto, <span class="kw">clear</span></span>
<span id="cb126-11"><a href="programar-ado---files.html#cb126-11" aria-hidden="true" tabindex="-1"></a>mimedia price mpg rep78 </span></code></pre></div>
</div>
<div id="programa-5" class="section level4 hasAnchor" number="4.0.3.5">
<h4><span class="header-section-number">4.0.3.5</span> Programa 5<a href="programar-ado---files.html#programa-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>El comando <code>macro shift</code> es útil, pero puede ser lento. Agregando variables locales usuales y un incremental es mucho mejor. Ojo con las dobles comillas.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb127-1"><a href="programar-ado---files.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> <span class="kw">program</span> <span class="kw">drop</span> mimedia </span>
<span id="cb127-2"><a href="programar-ado---files.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">define</span> mimedia </span>
<span id="cb127-3"><a href="programar-ado---files.html#cb127-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> i = 1</span>
<span id="cb127-4"><a href="programar-ado---files.html#cb127-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">while</span> <span class="st">&quot;``i&#39;&#39;&quot;</span>~=<span class="st">&quot;&quot;</span> { </span>
<span id="cb127-5"><a href="programar-ado---files.html#cb127-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">qui</span>: <span class="kw">egen</span> <span class="ot">``i&#39;</span>&#39;_mean = <span class="kw">mean</span>(<span class="ot">``i&#39;</span>&#39;) </span>
<span id="cb127-6"><a href="programar-ado---files.html#cb127-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="st">&quot;Media de `i&#39; = &quot;</span> <span class="ot">``i&#39;</span>&#39;_mean </span>
<span id="cb127-7"><a href="programar-ado---files.html#cb127-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">local</span> ++i</span>
<span id="cb127-8"><a href="programar-ado---files.html#cb127-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb127-9"><a href="programar-ado---files.html#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
</div>
</div>
<div id="programa-con-distintos-argumentos" class="section level3 hasAnchor" number="4.0.4">
<h3><span class="header-section-number">4.0.4</span> Programa con distintos argumentos<a href="programar-ado---files.html#programa-con-distintos-argumentos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El programa de los ejemplos anteriores soporta un solo argumento. Ahora vamos a ver un programa que considere explícitamente que los argumentos de un programa pueden tomar roles distintos.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb128-1"><a href="programar-ado---files.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span> </span>
<span id="cb128-2"><a href="programar-ado---files.html#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> <span class="kw">program</span> <span class="kw">drop</span> show </span>
<span id="cb128-3"><a href="programar-ado---files.html#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">define</span> show</span>
<span id="cb128-4"><a href="programar-ado---files.html#cb128-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempvar</span> <span class="kw">obs</span> </span>
<span id="cb128-5"><a href="programar-ado---files.html#cb128-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">gen</span> <span class="ot">`obs&#39;</span> = <span class="ot">`1&#39;</span> <span class="co">///</span></span>
<span id="cb128-6"><a href="programar-ado---files.html#cb128-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> (ctycode == <span class="st">&quot;`2&#39;&quot;</span> &amp; <span class="fu">year</span> ==<span class="ot">`3&#39;</span>)</span>
<span id="cb128-7"><a href="programar-ado---files.html#cb128-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">sort</span> <span class="ot">`obs&#39;</span></span>
<span id="cb128-8"><a href="programar-ado---files.html#cb128-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;`1&#39; of country `2&#39; in `3&#39; is: &quot;</span> <span class="ot">`obs&#39;</span> </span>
<span id="cb128-9"><a href="programar-ado---files.html#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p><code>tempvar</code> crea una variable temporal que existe mientras el programa se ejecuta pero que se elimina automáticamente una vez que el programa termina su ejecución. Es importante estar seguros(as) de que cualquier <em>string</em> están en comillas dobles.</p>
<div class="alert alert-block alert-warning">
<p><b>Ejercicio 3.5.2:</b></p>
<p>Preguntas</p>
<ol style="list-style-type: decimal">
<li>Escriba un programa que reporte la mediana de la diferencia entre dos variables.</li>
<li>Aplique este programa a la base <code>auto.dta</code>.</li>
</ol>
</div>
</div>
<div id="opción-syntax" class="section level3 hasAnchor" number="4.0.5">
<h3><span class="header-section-number">4.0.5</span> Opción Syntax<a href="programar-ado---files.html#opción-syntax" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Renombrando argumentos:</p>
<ul>
<li>De momento hemos escrito los programas utilizando <code>'1', '2', '3'</code> con el fin de introducir el uso de programas en Stata.</li>
<li>Sin embargo, esta notación puede ser un poco confusa y provocar errores en la codificación. Podemos asignar nombres de mayor significado a los argumentos del programa.</li>
</ul>
<div class="sourceCode" id="cb129"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb129-1"><a href="programar-ado---files.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span> </span>
<span id="cb129-2"><a href="programar-ado---files.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> <span class="kw">program</span> <span class="kw">drop</span> show </span>
<span id="cb129-3"><a href="programar-ado---files.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">define</span> show</span>
<span id="cb129-4"><a href="programar-ado---files.html#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">args</span> <span class="kw">var</span> cty yr</span>
<span id="cb129-5"><a href="programar-ado---files.html#cb129-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempvar</span> <span class="kw">obs</span> </span>
<span id="cb129-6"><a href="programar-ado---files.html#cb129-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">gen</span> <span class="ot">`obs&#39;</span> = <span class="ot">`var&#39;</span> <span class="co">///</span></span>
<span id="cb129-7"><a href="programar-ado---files.html#cb129-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> (ctycode == <span class="st">&quot;`cty&#39;&quot;</span> &amp; <span class="fu">year</span> ==<span class="ot">`yr&#39;</span>)</span>
<span id="cb129-8"><a href="programar-ado---files.html#cb129-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">sort</span> <span class="ot">`obs&#39;</span></span>
<span id="cb129-9"><a href="programar-ado---files.html#cb129-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;`1&#39; of country `2&#39; in `3&#39; is: &quot;</span> <span class="ot">`obs&#39;</span> </span>
<span id="cb129-10"><a href="programar-ado---files.html#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p>El comando<code>args</code> asigna a las variables locales <code>var</code>, <code>cty</code>, <code>yr</code> los valores de <code>'1'</code>, <code>'2'</code>, <code>'3'</code>. Noten que si llaman al programa con cuatro argumentos <strong>no</strong> retorna un error. Un método mucho más robusto y mejor para llamar a los argumentos de un programa es utilizar <code>syntax</code>. En vez de referirnos a cada elemento de un programa por su posición, vamos a especificar la “gramática” del programa.</p>
<p>La sintaxis de Stata es:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb130-1"><a href="programar-ado---files.html#cb130-1" aria-hidden="true" tabindex="-1"></a>[<span class="kw">by</span> <span class="kw">varlist</span>:] command [<span class="kw">varlist</span>] [=<span class="fu">exp</span>] [<span class="kw">in</span> <span class="kw">range</span>] [, options]</span></code></pre></div>
<p><code>varlist</code> denota la lista de variables, <code>command</code> el comando a ejecutar, <code>exp</code> denota una expresión algebraica, <code>range</code> denota un rango para las observaciones mientras que <code>,options</code> denota la lista de opciones propias de un comando. Utilizar <code>syntax</code> en un programa hace que Stata verifique si un programa satisface la sintaxis. En caso de que no la cumpla, arrojara un error.</p>
<p>Syntax
* El comando <code>syntax</code> almacena en macros locales todos los elementos típicos de un comando en Stata.
* Por ejemplo, <code>syntax</code> también puede definir condicionales como <code>if</code> o <code>in</code>.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb131-1"><a href="programar-ado---files.html#cb131-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">program</span> ... </span>
<span id="cb131-2"><a href="programar-ado---files.html#cb131-2" aria-hidden="true" tabindex="-1"></a>        <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">min</span> = 2) [<span class="kw">if</span>] [<span class="kw">in</span>]</span></code></pre></div>
<p>Si quieren hacer programas más complejos, con otras características es importante revisar <a href="https://www.stata.com/manuals/psyntax.pdf#psyntax">syntax</a>.</p>
<p>Uno de los primeros elementos de <code>syntax</code> es <code>varlist</code>. Es posible indicar el mínimo o máximo de variables.
* Por ejemplo: <code>varlist(min = 2 max = 2)</code>.
* Si tienes solo una variable puedes utilizar <code>varname</code>.
* Es equivalente a <code>varlist(min = 1 max = 1)</code>.
* La macro que guarda las variables siempre se llama <code>varlist</code>.</p>
<p>Ejemplo 1: programa para calcular percentiles</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb132-1"><a href="programar-ado---files.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb132-2"><a href="programar-ado---files.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb132-3"><a href="programar-ado---files.html#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>)</span>
<span id="cb132-4"><a href="programar-ado---files.html#cb132-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb132-5"><a href="programar-ado---files.html#cb132-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="kw">range</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb132-6"><a href="programar-ado---files.html#cb132-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> p7525 = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb132-7"><a href="programar-ado---files.html#cb132-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> p9010 = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb132-8"><a href="programar-ado---files.html#cb132-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;&quot;</span></span>
<span id="cb132-9"><a href="programar-ado---files.html#cb132-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> p7525</span>
<span id="cb132-10"><a href="programar-ado---files.html#cb132-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> p9010 </span>
<span id="cb132-11"><a href="programar-ado---files.html#cb132-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="kw">range</span></span>
<span id="cb132-12"><a href="programar-ado---files.html#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
<p>El programa anterior nos permite obtener los percentiles de alguna variable al mismo tiempo que los muestra en la consola. Noten que tambíen he incluido que tipo de comando es. En este caso es un comando <code>r-class</code>. <code>program</code> es quien determina el nombre del programa. <code>syntax</code> permite determinar los elementos de tu programa. En el ejemplo define el tipo y el límite de variables. También puede definir condicionales como <code>if</code> o <code>in</code>.</p>
<p>Los escalares definidos durante el programa se pueden utilizar. Esto no siempre es conveniente. Como recomendación es bueno <strong>guardar los programas como variables temporales</strong>.</p>
<p>Ejemplo 2: programa para calcular percentiles con variables locales</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb133-1"><a href="programar-ado---files.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb133-2"><a href="programar-ado---files.html#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb133-3"><a href="programar-ado---files.html#cb133-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>)</span>
<span id="cb133-4"><a href="programar-ado---files.html#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> res <span class="st">&quot;range p7525 p9010&quot;</span></span>
<span id="cb133-5"><a href="programar-ado---files.html#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb133-6"><a href="programar-ado---files.html#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;&quot;</span></span>
<span id="cb133-7"><a href="programar-ado---files.html#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb133-8"><a href="programar-ado---files.html#cb133-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb133-9"><a href="programar-ado---files.html#cb133-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb133-10"><a href="programar-ado---files.html#cb133-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb133-11"><a href="programar-ado---files.html#cb133-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb133-12"><a href="programar-ado---files.html#cb133-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010&#39;</span></span>
<span id="cb133-13"><a href="programar-ado---files.html#cb133-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span></code></pre></div>
</div>
<div id="return" class="section level3 hasAnchor" number="4.0.6">
<h3><span class="header-section-number">4.0.6</span> Return<a href="programar-ado---files.html#return" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Una característica importante de los comandos de Stata es su capacidad de reportar los resultados de forma tal de que los usuarios y usuarias podamos utilizarlos posteriormente.</li>
<li>El comando <code>return</code> nos permite guardar los escalares y hacerlos accesibles, sin tener el problema que vimos en el ejemplo anterior.<br />
</li>
<li>Notar que el lado izquierdo del escalar de retorno se refiere al nombre de la macro, el lado derecho debe hacer referencia a la macro una vez más para extraer el valor almacenado en ese nombre, por lo que debe utilizar dos comillas.</li>
</ul>
<p>Ejemplo 3: programa para calcular percentiles con return</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb134-1"><a href="programar-ado---files.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb134-2"><a href="programar-ado---files.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb134-3"><a href="programar-ado---files.html#cb134-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>)</span>
<span id="cb134-4"><a href="programar-ado---files.html#cb134-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> res <span class="st">&quot;range p7525 p9010&quot;</span></span>
<span id="cb134-5"><a href="programar-ado---files.html#cb134-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb134-6"><a href="programar-ado---files.html#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;&quot;</span></span>
<span id="cb134-7"><a href="programar-ado---files.html#cb134-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb134-8"><a href="programar-ado---files.html#cb134-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb134-9"><a href="programar-ado---files.html#cb134-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb134-10"><a href="programar-ado---files.html#cb134-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb134-11"><a href="programar-ado---files.html#cb134-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb134-12"><a href="programar-ado---files.html#cb134-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010 &#39;</span></span>
<span id="cb134-13"><a href="programar-ado---files.html#cb134-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span>
<span id="cb134-14"><a href="programar-ado---files.html#cb134-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="fu">r</span> <span class="kw">of</span> <span class="kw">local</span> res {</span>
<span id="cb134-15"><a href="programar-ado---files.html#cb134-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="fu">scalar</span> <span class="ot">`r&#39;</span> = <span class="ot">``r&#39;</span>&#39;</span>
<span id="cb134-16"><a href="programar-ado---files.html#cb134-16" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb134-17"><a href="programar-ado---files.html#cb134-17" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
</div>
<div id="implementar-opciones-al-programa" class="section level3 hasAnchor" number="4.0.7">
<h3><span class="header-section-number">4.0.7</span> Implementar opciones al programa<a href="programar-ado---files.html#implementar-opciones-al-programa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Podemos agregar distintas opciones al programa. Una opción es agregar como opcional que el programa de un resultado en la consola. Al incluir <span class="math inline">\([ ]\)</span> en <code>syntax</code> significa un componente <strong>opcional</strong> en el comando.</p>
<p>Ejemplo 4: implementar opciones al programa (imprimir por defecto)</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb135-1"><a href="programar-ado---files.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb135-2"><a href="programar-ado---files.html#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb135-3"><a href="programar-ado---files.html#cb135-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>) [, PRINT]</span>
<span id="cb135-4"><a href="programar-ado---files.html#cb135-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> res <span class="st">&quot;range p7525 p9010&quot;</span></span>
<span id="cb135-5"><a href="programar-ado---files.html#cb135-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb135-6"><a href="programar-ado---files.html#cb135-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;&quot;</span></span>
<span id="cb135-7"><a href="programar-ado---files.html#cb135-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb135-8"><a href="programar-ado---files.html#cb135-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb135-9"><a href="programar-ado---files.html#cb135-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb135-10"><a href="programar-ado---files.html#cb135-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb135-11"><a href="programar-ado---files.html#cb135-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="st">&quot;`print&#39;&quot;</span> == <span class="st">&quot;print&quot;</span> {</span>
<span id="cb135-12"><a href="programar-ado---files.html#cb135-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb135-13"><a href="programar-ado---files.html#cb135-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010 &#39;</span></span>
<span id="cb135-14"><a href="programar-ado---files.html#cb135-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span>
<span id="cb135-15"><a href="programar-ado---files.html#cb135-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb135-16"><a href="programar-ado---files.html#cb135-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="fu">r</span> <span class="kw">of</span> <span class="kw">local</span> res {</span>
<span id="cb135-17"><a href="programar-ado---files.html#cb135-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="fu">scalar</span> <span class="ot">`r&#39;</span> = <span class="ot">``r&#39;</span>&#39;</span>
<span id="cb135-18"><a href="programar-ado---files.html#cb135-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb135-19"><a href="programar-ado---files.html#cb135-19" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
<p>Ejemplo 5: implementar opciones al programa (no imprimir por defecto)</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb136-1"><a href="programar-ado---files.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb136-2"><a href="programar-ado---files.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb136-3"><a href="programar-ado---files.html#cb136-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>) [, noPRINT]</span>
<span id="cb136-4"><a href="programar-ado---files.html#cb136-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> res <span class="st">&quot;range p7525 p9010&quot;</span></span>
<span id="cb136-5"><a href="programar-ado---files.html#cb136-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb136-6"><a href="programar-ado---files.html#cb136-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;&quot;</span></span>
<span id="cb136-7"><a href="programar-ado---files.html#cb136-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb136-8"><a href="programar-ado---files.html#cb136-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb136-9"><a href="programar-ado---files.html#cb136-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb136-10"><a href="programar-ado---files.html#cb136-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb136-11"><a href="programar-ado---files.html#cb136-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="st">&quot;`print&#39;&quot;</span> != <span class="st">&quot;noprint&quot;</span> {</span>
<span id="cb136-12"><a href="programar-ado---files.html#cb136-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb136-13"><a href="programar-ado---files.html#cb136-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010 &#39;</span></span>
<span id="cb136-14"><a href="programar-ado---files.html#cb136-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span>
<span id="cb136-15"><a href="programar-ado---files.html#cb136-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb136-16"><a href="programar-ado---files.html#cb136-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="fu">r</span> <span class="kw">of</span> <span class="kw">local</span> res {</span>
<span id="cb136-17"><a href="programar-ado---files.html#cb136-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="fu">scalar</span> <span class="ot">`r&#39;</span> = <span class="ot">``r&#39;</span>&#39;</span>
<span id="cb136-18"><a href="programar-ado---files.html#cb136-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb136-19"><a href="programar-ado---files.html#cb136-19" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
</div>
<div id="incluir-ifin-al-programa" class="section level3 hasAnchor" number="4.0.8">
<h3><span class="header-section-number">4.0.8</span> Incluir if/in al programa<a href="programar-ado---files.html#incluir-ifin-al-programa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Incluir un subconjunto de observaciones</p>
<ul>
<li>Cualquier comando debiese incluir <code>if</code> o <code>in range</code>.</li>
<li>Nuevamente, estas opciones son manejadas dentro del comando <code>syntax</code>. Para incluir estas opciones hay que agregar <code>[if]</code> y <code>[in]</code>.</li>
<li>Con estos comandos puedo ejecutar el programa para sub-muestras. Es importante asegurar que la sub-muestra no es vacía. Para ello es importante calcular <code>r(N)</code>, chequear que sea distinto de cero y agregar un título que lo indique.</li>
<li>El comando <code>marksample touse</code> utiliza la información provista por <code>if</code> o <code>in</code> en caso de que estos sean indicados en el programa. Este comando genera una variable local <code>touse</code> que es igual a 1 si las variables entran en el calculo que hace el programa y 0 en caso contrario.</li>
<li>Utilizaremos <code>'touse'</code> para calcular el número de observaciones que se utilizan después de aplicar los condicionales. Es necesario agregar <code>'touse'</code> en cada parte del programa que trabaje con la variable de <em>input</em>.</li>
</ul>
<p>Ejemplo 6: Incluir un subconjunto de observaciones</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb137-1"><a href="programar-ado---files.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb137-2"><a href="programar-ado---files.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb137-3"><a href="programar-ado---files.html#cb137-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>) [, noPRINT]</span>
<span id="cb137-4"><a href="programar-ado---files.html#cb137-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> res <span class="st">&quot;range p7525 p9010&quot;</span></span>
<span id="cb137-5"><a href="programar-ado---files.html#cb137-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb137-6"><a href="programar-ado---files.html#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;&quot;</span></span>
<span id="cb137-7"><a href="programar-ado---files.html#cb137-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb137-8"><a href="programar-ado---files.html#cb137-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb137-9"><a href="programar-ado---files.html#cb137-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb137-10"><a href="programar-ado---files.html#cb137-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb137-11"><a href="programar-ado---files.html#cb137-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="st">&quot;`print&#39;&quot;</span> != <span class="st">&quot;noprint&quot;</span> {</span>
<span id="cb137-12"><a href="programar-ado---files.html#cb137-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb137-13"><a href="programar-ado---files.html#cb137-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010 &#39;</span></span>
<span id="cb137-14"><a href="programar-ado---files.html#cb137-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span>
<span id="cb137-15"><a href="programar-ado---files.html#cb137-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb137-16"><a href="programar-ado---files.html#cb137-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="fu">r</span> <span class="kw">of</span> <span class="kw">local</span> res {</span>
<span id="cb137-17"><a href="programar-ado---files.html#cb137-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="fu">scalar</span> <span class="ot">`r&#39;</span> = <span class="ot">``r&#39;</span>&#39;</span>
<span id="cb137-18"><a href="programar-ado---files.html#cb137-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb137-19"><a href="programar-ado---files.html#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
</div>
<div id="generalizar-el-comando-para-incluir-múltiples-variables" class="section level3 hasAnchor" number="4.0.9">
<h3><span class="header-section-number">4.0.9</span> Generalizar el comando para incluir múltiples variables<a href="programar-ado---files.html#generalizar-el-comando-para-incluir-múltiples-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Algunas consideraciones</p>
<ul>
<li>Si quiero ejecutar el programa sobre múltiples variables, es necesario ajustar un poco el programa.</li>
<li>Tengo que indicarle a <code>syntax</code> que hay más de una variable. Además, tengo que indicarle al programa que en caso de que existan más variables muestre los resultados en una tabla.</li>
<li>Guardaremos los resultados en matrices (no escalares) y vamos a aplicar una <strong>función de macro extendida</strong> con el fin de contar el número de filas que esta matriz debiese tener.</li>
<li>Agregaremos también una la opción para cambiar el formato y la opción <code>mat</code> que permite a la matriz ser guardada automáticamente con el nombre indicado.</li>
</ul>
<p>Ejemplo 7</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb138-1"><a href="programar-ado---files.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span> </span>
<span id="cb138-2"><a href="programar-ado---files.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass</span>
<span id="cb138-3"><a href="programar-ado---files.html#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb138-4"><a href="programar-ado---files.html#cb138-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">min</span> = 1 <span class="kw">numeric</span> ts) [<span class="kw">if</span>] [<span class="kw">in</span>] [, noPRINT FORmat(passthru) MATrix(<span class="fu">string</span>)] </span>
<span id="cb138-5"><a href="programar-ado---files.html#cb138-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">marksample</span> touse </span>
<span id="cb138-6"><a href="programar-ado---files.html#cb138-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="fu">count</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span></span>
<span id="cb138-7"><a href="programar-ado---files.html#cb138-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="ot">`r(N)&#39;</span> == 0 {</span>
<span id="cb138-8"><a href="programar-ado---files.html#cb138-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">error</span> 2000</span>
<span id="cb138-9"><a href="programar-ado---files.html#cb138-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb138-10"><a href="programar-ado---files.html#cb138-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> nvar: <span class="fu">word</span> <span class="fu">count</span> <span class="ot">`varlist&#39;</span></span>
<span id="cb138-11"><a href="programar-ado---files.html#cb138-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="ot">`nvar&#39;</span> == 1 {</span>
<span id="cb138-12"><a href="programar-ado---files.html#cb138-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">local</span> res <span class="kw">range</span> p7525 p9010</span>
<span id="cb138-13"><a href="programar-ado---files.html#cb138-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb138-14"><a href="programar-ado---files.html#cb138-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb138-15"><a href="programar-ado---files.html#cb138-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb138-16"><a href="programar-ado---files.html#cb138-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb138-17"><a href="programar-ado---files.html#cb138-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb138-18"><a href="programar-ado---files.html#cb138-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb138-19"><a href="programar-ado---files.html#cb138-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="st">&quot;`print&#39;&quot;</span> != <span class="st">&quot;noprint&quot;</span> {</span>
<span id="cb138-20"><a href="programar-ado---files.html#cb138-20" aria-hidden="true" tabindex="-1"></a>            <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;, N = `r(N)&#39;&quot;</span></span>
<span id="cb138-21"><a href="programar-ado---files.html#cb138-21" aria-hidden="true" tabindex="-1"></a>            <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb138-22"><a href="programar-ado---files.html#cb138-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010 &#39;</span></span>
<span id="cb138-23"><a href="programar-ado---files.html#cb138-23" aria-hidden="true" tabindex="-1"></a>            <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span>
<span id="cb138-24"><a href="programar-ado---files.html#cb138-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb138-25"><a href="programar-ado---files.html#cb138-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb138-26"><a href="programar-ado---files.html#cb138-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="fu">r</span> <span class="kw">of</span> <span class="kw">local</span> res {</span>
<span id="cb138-27"><a href="programar-ado---files.html#cb138-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="fu">scalar</span> <span class="ot">`r&#39;</span> = <span class="ot">``r&#39;</span>&#39;</span>
<span id="cb138-28"><a href="programar-ado---files.html#cb138-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb138-29"><a href="programar-ado---files.html#cb138-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> <span class="fu">scalar</span> <span class="kw">N</span> = <span class="fu">r</span>(<span class="kw">N</span>)</span>
<span id="cb138-30"><a href="programar-ado---files.html#cb138-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb138-31"><a href="programar-ado---files.html#cb138-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">else</span> {</span>
<span id="cb138-32"><a href="programar-ado---files.html#cb138-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> rmat </span>
<span id="cb138-33"><a href="programar-ado---files.html#cb138-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span> <span class="ot">`rmat&#39;</span> = <span class="fu">J</span>(<span class="ot">`nvar&#39;</span>, 3, .)</span>
<span id="cb138-34"><a href="programar-ado---files.html#cb138-34" aria-hidden="true" tabindex="-1"></a>      <span class="kw">local</span> i 0 </span>
<span id="cb138-35"><a href="programar-ado---files.html#cb138-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreach</span> v <span class="kw">of</span> <span class="kw">varlist</span> <span class="ot">`varlist&#39;</span>{</span>
<span id="cb138-36"><a href="programar-ado---files.html#cb138-36" aria-hidden="true" tabindex="-1"></a>        <span class="kw">local</span> ++i </span>
<span id="cb138-37"><a href="programar-ado---files.html#cb138-37" aria-hidden="true" tabindex="-1"></a>        <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`v&#39;</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb138-38"><a href="programar-ado---files.html#cb138-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">matrix</span> <span class="ot">`rmat&#39;</span>[<span class="ot">`i&#39;</span> ,1] = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb138-39"><a href="programar-ado---files.html#cb138-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">matrix</span> <span class="ot">`rmat&#39;</span>[<span class="ot">`i&#39;</span>, 2] = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb138-40"><a href="programar-ado---files.html#cb138-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">matrix</span> <span class="ot">`rmat&#39;</span>[<span class="ot">`i&#39;</span>, 3] = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb138-41"><a href="programar-ado---files.html#cb138-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">local</span> <span class="ot">rown</span> <span class="ot">`rown&#39;</span> <span class="ot">`v&#39;</span></span>
<span id="cb138-42"><a href="programar-ado---files.html#cb138-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb138-43"><a href="programar-ado---files.html#cb138-43" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb138-44"><a href="programar-ado---files.html#cb138-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span> <span class="ot">colnames</span> <span class="ot">`rmat&#39;</span> = Range P75-P25 P90-P10 </span>
<span id="cb138-45"><a href="programar-ado---files.html#cb138-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span> <span class="ot">rownames</span> <span class="ot">`rmat&#39;</span> = <span class="ot">`rown&#39;</span> </span>
<span id="cb138-46"><a href="programar-ado---files.html#cb138-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-47"><a href="programar-ado---files.html#cb138-47" aria-hidden="true" tabindex="-1"></a>      <span class="kw">if</span> <span class="st">&quot;`print&#39;&quot;</span> != <span class="st">&quot;noprint&quot;</span> {</span>
<span id="cb138-48"><a href="programar-ado---files.html#cb138-48" aria-hidden="true" tabindex="-1"></a>          <span class="kw">local</span> form <span class="st">&quot;, noheader&quot;</span></span>
<span id="cb138-49"><a href="programar-ado---files.html#cb138-49" aria-hidden="true" tabindex="-1"></a>          <span class="kw">if</span> <span class="st">&quot;`format&#39;&quot;</span> != <span class="st">&quot;&quot;</span> {</span>
<span id="cb138-50"><a href="programar-ado---files.html#cb138-50" aria-hidden="true" tabindex="-1"></a>                <span class="kw">local</span> form <span class="st">&quot;`form&#39; `format&#39;&quot;</span> </span>
<span id="cb138-51"><a href="programar-ado---files.html#cb138-51" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb138-52"><a href="programar-ado---files.html#cb138-52" aria-hidden="true" tabindex="-1"></a>          <span class="fu">matrix</span> <span class="ot">list</span> <span class="ot">`rmat&#39;</span> <span class="ot">`form&#39;</span></span>
<span id="cb138-53"><a href="programar-ado---files.html#cb138-53" aria-hidden="true" tabindex="-1"></a>                                }</span>
<span id="cb138-54"><a href="programar-ado---files.html#cb138-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-55"><a href="programar-ado---files.html#cb138-55" aria-hidden="true" tabindex="-1"></a>      <span class="kw">if</span> <span class="st">&quot;`matrix&#39;&quot;</span> != <span class="st">&quot;&quot;</span> {</span>
<span id="cb138-56"><a href="programar-ado---files.html#cb138-56" aria-hidden="true" tabindex="-1"></a>            <span class="fu">matrix</span> <span class="ot">`matrix&#39;</span> = <span class="ot">`rmat&#39;</span></span>
<span id="cb138-57"><a href="programar-ado---files.html#cb138-57" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb138-58"><a href="programar-ado---files.html#cb138-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span> <span class="fu">matrix</span> rmat = <span class="ot">`rmat&#39;</span></span>
<span id="cb138-59"><a href="programar-ado---files.html#cb138-59" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb138-60"><a href="programar-ado---files.html#cb138-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span> <span class="kw">local</span> varname <span class="ot">`varlist&#39;</span></span>
<span id="cb138-61"><a href="programar-ado---files.html#cb138-61" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
</div>
<div id="agregar-prefijos-a-los-programas" class="section level3 hasAnchor" number="4.0.10">
<h3><span class="header-section-number">4.0.10</span> Agregar prefijos a los programas<a href="programar-ado---files.html#agregar-prefijos-a-los-programas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Prefijo by</p>
<ul>
<li>Ahora vamos a hacer que nuestro programa pueda utilizar el prefijo <code>by</code>.</li>
<li>Para agregar esta opción simplemente hay qyue modificar <code>program</code>.</li>
</ul>
<div class="sourceCode" id="cb139"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb139-1"><a href="programar-ado---files.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass byable(recall)</span></code></pre></div>
<p>También podemos permitir que la lista de variables incluya <strong>operadores de series de tiempo</strong> (ej. <code>L.pib</code>, <code>D.ingreso</code>). Para incorporar estos elementos tenemos que modificar <code>syntax</code>.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb140-1"><a href="programar-ado---files.html#cb140-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">min</span> = 1 <span class="kw">numeric</span> ts) [<span class="kw">if</span>] [<span class="kw">in</span>] <span class="co">///</span></span>
<span id="cb140-2"><a href="programar-ado---files.html#cb140-2" aria-hidden="true" tabindex="-1"></a>    [, noPRINT  FORmat(passthru) MATrix(<span class="fu">string</span>)]</span></code></pre></div>
</div>
<div id="programas-para-complementar-función-egen" class="section level3 hasAnchor" number="4.0.11">
<h3><span class="header-section-number">4.0.11</span> Programas para complementar función egen<a href="programar-ado---files.html#programas-para-complementar-función-egen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Es posible programar funciones adicionales de <code>egen</code>. El nombre de estos programas deben empezar con <code>_g</code>. Una diferencia importante entre este tipo de programas y los que ya hemos escrito guarda relación con el hecho de que hay que tener en cuenta la nueva variable que se va a crear. La sintaxis es la siguiente:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb141-1"><a href="programar-ado---files.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> [<span class="dv">type</span>] newvarname = fcn(arguments) [<span class="kw">if</span>] [<span class="kw">in</span>] [, options]</span></code></pre></div>
<p>El cambio que haremos en la sintaxis del programa será que incluiremos un <code>touse</code> para hacer la nueva variable.</p>
<p>Ejemplo 8: programa función egen</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb142-1"><a href="programar-ado---files.html#cb142-1" aria-hidden="true" tabindex="-1"></a>* Programas <span class="kw">de</span> <span class="kw">egen</span> </span>
<span id="cb142-2"><a href="programar-ado---files.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span></span>
<span id="cb142-3"><a href="programar-ado---files.html#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> _gpct9010</span>
<span id="cb142-4"><a href="programar-ado---files.html#cb142-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> newvarname =/<span class="fu">exp</span> [<span class="kw">if</span>] [<span class="kw">in</span>] </span>
<span id="cb142-5"><a href="programar-ado---files.html#cb142-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempvar</span> touse </span>
<span id="cb142-6"><a href="programar-ado---files.html#cb142-6" aria-hidden="true" tabindex="-1"></a>    mark <span class="ot">`touse&#39;</span> <span class="ot">`if&#39;</span> <span class="ot">`in&#39;</span> </span>
<span id="cb142-7"><a href="programar-ado---files.html#cb142-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`exp&#39;</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb142-8"><a href="programar-ado---files.html#cb142-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">generate</span> <span class="ot">`typlist&#39;</span> <span class="ot">`varlist&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10) <span class="kw">if</span> <span class="ot">`touse&#39;</span></span>
<span id="cb142-9"><a href="programar-ado---files.html#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb142-10"><a href="programar-ado---files.html#cb142-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-11"><a href="programar-ado---files.html#cb142-11" aria-hidden="true" tabindex="-1"></a>* Aplicación del programa</span>
<span id="cb142-12"><a href="programar-ado---files.html#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="kw">sysuse</span> auto, <span class="kw">clear</span></span>
<span id="cb142-13"><a href="programar-ado---files.html#cb142-13" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> rango9010 = pct9010(price)</span></code></pre></div>
<p>Programas con funciones de egen con prefijo by</p>
<ul>
<li>Agregamos <code>[, *]</code> que corresponde a las opciones. En <code>egen</code> el prefijo <code>by</code> es una opción.</li>
<li>Con el fin de permitirle al programa que pueda producir un rango de percentil separado para cada grupos utilizaremos <code>pctile</code> en vez de <code>summarize</code>.</li>
<li>El cambio que haremos en la sintaxis del programa será que incluiremos un <code>touse</code> para hacer la nueva variable.</li>
</ul>
<p>Ejemplo 9: programa función egen con prefijo by</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb143-1"><a href="programar-ado---files.html#cb143-1" aria-hidden="true" tabindex="-1"></a>* Programa con opción <span class="kw">by</span>. </span>
<span id="cb143-2"><a href="programar-ado---files.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span></span>
<span id="cb143-3"><a href="programar-ado---files.html#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> _gpct9010</span>
<span id="cb143-4"><a href="programar-ado---files.html#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> newvarname =/<span class="fu">exp</span> [<span class="kw">if</span>] [<span class="kw">in</span>] [, *] </span>
<span id="cb143-5"><a href="programar-ado---files.html#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="kw">tempvar</span> touse p90 p10 </span>
<span id="cb143-6"><a href="programar-ado---files.html#cb143-6" aria-hidden="true" tabindex="-1"></a>mark <span class="ot">`touse&#39;</span> <span class="ot">`if&#39;</span> <span class="ot">`in&#39;</span> </span>
<span id="cb143-7"><a href="programar-ado---files.html#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="kw">quietly</span> {</span>
<span id="cb143-8"><a href="programar-ado---files.html#cb143-8" aria-hidden="true" tabindex="-1"></a>          <span class="kw">egen</span> <span class="kw">double</span> <span class="ot">`p90&#39;</span> = <span class="kw">pctile</span>(<span class="ot">`exp&#39;</span>) <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="ot">`options&#39;</span> <span class="kw">p</span>(90) </span>
<span id="cb143-9"><a href="programar-ado---files.html#cb143-9" aria-hidden="true" tabindex="-1"></a>          <span class="kw">egen</span> <span class="kw">double</span> <span class="ot">`p10&#39;</span> = <span class="kw">pctile</span>(<span class="ot">`exp&#39;</span>) <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="ot">`options&#39;</span> <span class="kw">p</span>(10)</span>
<span id="cb143-10"><a href="programar-ado---files.html#cb143-10" aria-hidden="true" tabindex="-1"></a>          <span class="kw">generate</span> <span class="ot">`typlist&#39;</span> <span class="ot">`varlist&#39;</span> = <span class="ot">`p90&#39;</span> - <span class="ot">`p10&#39;</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span> } </span>
<span id="cb143-11"><a href="programar-ado---files.html#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb143-12"><a href="programar-ado---files.html#cb143-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-13"><a href="programar-ado---files.html#cb143-13" aria-hidden="true" tabindex="-1"></a>* Aplicación del programa</span>
<span id="cb143-14"><a href="programar-ado---files.html#cb143-14" aria-hidden="true" tabindex="-1"></a><span class="kw">sysuse</span> auto, <span class="kw">clear</span></span>
<span id="cb143-15"><a href="programar-ado---files.html#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> rango9010 = pct9010(price)</span>
<span id="cb143-16"><a href="programar-ado---files.html#cb143-16" aria-hidden="true" tabindex="-1"></a><span class="kw">bysort</span> rep78 foreign: <span class="kw">egen</span> rango9010_prefijoby = pct9010(price)</span></code></pre></div>
<p>Generalización de la función egen para soportar todos los pares de cuantiles</p>
<ul>
<li>Hemos desarrollado una función de <code>egen</code> que permite calcular un rango entre percentiles para una lista de variables especifica.</li>
<li>Puede ser util tomar ventaja de <code>egen pctile()</code> para poder calcular cualquier percentil de la lista de variables especificadas.</li>
<li>Vamos a agregar dos opciones a la función <code>egen</code> : <code>lo()</code> y <code>hi()</code>. En caso de que no especifiquemos, por defecto se calcula el rango interquartil. La función de <code>egen</code> ahora se llamará <code>_gpctrange.ado</code>.</li>
</ul>
<p>Ejemplo 10: función <code>egen</code> más general</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb144-1"><a href="programar-ado---files.html#cb144-1" aria-hidden="true" tabindex="-1"></a>* Programa con opción <span class="kw">by</span>. </span>
<span id="cb144-2"><a href="programar-ado---files.html#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span></span>
<span id="cb144-3"><a href="programar-ado---files.html#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> _gpctrange</span>
<span id="cb144-4"><a href="programar-ado---files.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> newvarname =/<span class="fu">exp</span> [<span class="kw">if</span>] [<span class="kw">in</span>] [, LO(integer 25) HI(integer 75) *] </span>
<span id="cb144-5"><a href="programar-ado---files.html#cb144-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-6"><a href="programar-ado---files.html#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ot">`hi&#39;</span> &gt; 99 | <span class="ot">`lo&#39;</span> &lt; 1 {</span>
<span id="cb144-7"><a href="programar-ado---files.html#cb144-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> <span class="kw">error</span> <span class="co">///</span></span>
<span id="cb144-8"><a href="programar-ado---files.html#cb144-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Percentiles `lo&#39; `hi&#39; deben estar entre 1 y 99.&quot;</span> </span>
<span id="cb144-9"><a href="programar-ado---files.html#cb144-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">error</span> 198 </span>
<span id="cb144-10"><a href="programar-ado---files.html#cb144-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb144-11"><a href="programar-ado---files.html#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ot">`hi&#39;</span> &lt;= <span class="ot">`lo&#39;</span> {</span>
<span id="cb144-12"><a href="programar-ado---files.html#cb144-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> <span class="kw">error</span> <span class="co">///</span></span>
<span id="cb144-13"><a href="programar-ado---files.html#cb144-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Percentiles `lo&#39; `hi&#39; deben estar en orden ascendente&quot;</span></span>
<span id="cb144-14"><a href="programar-ado---files.html#cb144-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">error</span> 198 </span>
<span id="cb144-15"><a href="programar-ado---files.html#cb144-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb144-16"><a href="programar-ado---files.html#cb144-16" aria-hidden="true" tabindex="-1"></a><span class="kw">tempvar</span> touse phi plo </span>
<span id="cb144-17"><a href="programar-ado---files.html#cb144-17" aria-hidden="true" tabindex="-1"></a>mark <span class="ot">`touse&#39;</span> <span class="ot">`if&#39;</span> <span class="ot">`in&#39;</span> </span>
<span id="cb144-18"><a href="programar-ado---files.html#cb144-18" aria-hidden="true" tabindex="-1"></a><span class="kw">quietly</span> {</span>
<span id="cb144-19"><a href="programar-ado---files.html#cb144-19" aria-hidden="true" tabindex="-1"></a>          <span class="kw">egen</span> <span class="kw">double</span> <span class="ot">`phi&#39;</span> = <span class="kw">pctile</span>(<span class="ot">`exp&#39;</span>) <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="ot">`options&#39;</span> <span class="kw">p</span>(<span class="ot">`hi&#39;</span>) </span>
<span id="cb144-20"><a href="programar-ado---files.html#cb144-20" aria-hidden="true" tabindex="-1"></a>          <span class="kw">egen</span> <span class="kw">double</span> <span class="ot">`plo&#39;</span> = <span class="kw">pctile</span>(<span class="ot">`exp&#39;</span>) <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="ot">`options&#39;</span> <span class="kw">p</span>(<span class="ot">`lo&#39;</span>)</span>
<span id="cb144-21"><a href="programar-ado---files.html#cb144-21" aria-hidden="true" tabindex="-1"></a>          <span class="kw">generate</span> <span class="ot">`typlist&#39;</span> <span class="ot">`varlist&#39;</span> = <span class="ot">`phi&#39;</span> - <span class="ot">`plo&#39;</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span> </span>
<span id="cb144-22"><a href="programar-ado---files.html#cb144-22" aria-hidden="true" tabindex="-1"></a>          } </span>
<span id="cb144-23"><a href="programar-ado---files.html#cb144-23" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb144-24"><a href="programar-ado---files.html#cb144-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-25"><a href="programar-ado---files.html#cb144-25" aria-hidden="true" tabindex="-1"></a><span class="kw">sysuse</span> auto, <span class="kw">clear</span></span>
<span id="cb144-26"><a href="programar-ado---files.html#cb144-26" aria-hidden="true" tabindex="-1"></a><span class="kw">bysort</span> rep78: <span class="kw">egen</span> <span class="fu">iqr</span> = pctrange(price) <span class="kw">if</span> <span class="fu">inrange</span>(rep78,3,5)</span>
<span id="cb144-27"><a href="programar-ado---files.html#cb144-27" aria-hidden="true" tabindex="-1"></a><span class="kw">bysort</span> rep78: <span class="kw">egen</span> p8020 = pctrange(price) <span class="kw">if</span> <span class="fu">inrange</span>(rep78,3,5), hi(80) lo(20)</span>
<span id="cb144-28"><a href="programar-ado---files.html#cb144-28" aria-hidden="true" tabindex="-1"></a><span class="kw">tabstat</span> <span class="fu">iqr</span> <span class="kw">if</span> <span class="fu">inrange</span>(rep78, 3, 5), <span class="kw">by</span>(rep78)</span>
<span id="cb144-29"><a href="programar-ado---files.html#cb144-29" aria-hidden="true" tabindex="-1"></a><span class="kw">tabstat</span> p8020 <span class="kw">if</span> <span class="fu">inrange</span>(rep78, 3, 5), <span class="kw">by</span>(rep78)</span></code></pre></div>
</div>
<div id="syntax" class="section level3 hasAnchor" number="4.0.12">
<h3><span class="header-section-number">4.0.12</span> Syntax<a href="programar-ado---files.html#syntax" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Algunas consideraciones</p>
<ul>
<li>Como hemos visto hay dos formas en los que un programa de Stata puede interpretar lo que ingresamos.</li>
<li>Por posición tal como lo hace <code>args</code> o como lo hicimos con los números entre las comillas.<br />
</li>
<li>De acuerdo a la gramática del programa utilizando <code>syntax</code>.</li>
<li><code>syntax</code> guarda los componentes en macros locales particulares a las cuales podemos acceder posteriormente.</li>
<li>Por ejemplo <code>'if'</code> <code>'in'</code> <code>'varlist'</code> son macros locales a las que podemos acceder tal como vimos la clase pasada.</li>
<li>Ahora vamos a ver algunas opciones de <code>syntax</code> que nos permitirán tener más herramientas para escribir nuestros programas.</li>
<li>Al utilizar dentro de un programa paréntesis cuadrados estoy indicando que esas partes son opcionales.</li>
<li>Por ejemplo, estas dos versiones son equivalentes, salvo que en la segunda linea todo es opcional:</li>
</ul>
<div class="sourceCode" id="cb145"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb145-1"><a href="programar-ado---files.html#cb145-1" aria-hidden="true" tabindex="-1"></a>    * Nada opcional</span>
<span id="cb145-2"><a href="programar-ado---files.html#cb145-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span> <span class="kw">if</span> <span class="kw">in</span> <span class="bn">title</span>(<span class="fu">string</span>) <span class="kw">adjust</span>(<span class="fu">real</span> 1) </span>
<span id="cb145-3"><a href="programar-ado---files.html#cb145-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb145-4"><a href="programar-ado---files.html#cb145-4" aria-hidden="true" tabindex="-1"></a>    * Todo opcional</span>
<span id="cb145-5"><a href="programar-ado---files.html#cb145-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> [<span class="kw">varlist</span>] [<span class="kw">if</span>] [, <span class="kw">adjust</span> (<span class="fu">real</span> 1) <span class="bn">title</span>(<span class="fu">string</span>)]</span></code></pre></div>
<p>Vamos a mirar las macros generadas por syntax:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb146-1"><a href="programar-ado---files.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> <span class="kw">program</span> <span class="kw">drop</span> myprog</span>
<span id="cb146-2"><a href="programar-ado---files.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> myprog </span>
<span id="cb146-3"><a href="programar-ado---files.html#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> <span class="kw">varlist</span> [<span class="kw">if</span>] [<span class="kw">in</span>] [, <span class="kw">adjust</span>(<span class="fu">real</span> 1) <span class="bn">title</span>(<span class="fu">string</span>)] </span>
<span id="cb146-4"><a href="programar-ado---files.html#cb146-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;varlist contiene |`varlist&#39;|&quot;</span> </span>
<span id="cb146-5"><a href="programar-ado---files.html#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;if contiene |`if&#39;|&quot;</span> </span>
<span id="cb146-6"><a href="programar-ado---files.html#cb146-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;in contiene |`in&#39;|&quot;</span> </span>
<span id="cb146-7"><a href="programar-ado---files.html#cb146-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;adjust contiene |`adjust&#39;|&quot;</span> </span>
<span id="cb146-8"><a href="programar-ado---files.html#cb146-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;title contiene |`title&#39;|&quot;</span> </span>
<span id="cb146-9"><a href="programar-ado---files.html#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p>Vamos a aplicar lo aprendido en un ejemplo sencillo:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb147-1"><a href="programar-ado---files.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> <span class="kw">program</span> <span class="kw">drop</span> miprograma</span>
<span id="cb147-2"><a href="programar-ado---files.html#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> miprograma</span>
<span id="cb147-3"><a href="programar-ado---files.html#cb147-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span> [<span class="kw">if</span>] [<span class="kw">in</span>] [, <span class="kw">adjust</span>(<span class="fu">real</span> 1) <span class="bn">title</span>(<span class="fu">string</span>)]</span>
<span id="cb147-4"><a href="programar-ado---files.html#cb147-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> </span>
<span id="cb147-5"><a href="programar-ado---files.html#cb147-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="st">&quot;`title&#39;&quot;</span> != <span class="st">&quot;&quot;</span> {</span>
<span id="cb147-6"><a href="programar-ado---files.html#cb147-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="st">&quot;`title&#39;:&quot;</span></span>
<span id="cb147-7"><a href="programar-ado---files.html#cb147-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb147-8"><a href="programar-ado---files.html#cb147-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="kw">var</span> <span class="kw">of</span> <span class="kw">local</span> <span class="kw">varlist</span>{</span>
<span id="cb147-9"><a href="programar-ado---files.html#cb147-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`var&#39;</span> <span class="ot">`if&#39;</span> <span class="ot">`in&#39;</span></span>
<span id="cb147-10"><a href="programar-ado---files.html#cb147-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="st">&quot;`var&#39;&quot;</span> <span class="st">&quot; &quot;</span>%9.0g <span class="fu">r</span>(<span class="kw">mean</span>)*<span class="ot">`adjust&#39;</span></span>
<span id="cb147-11"><a href="programar-ado---files.html#cb147-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb147-12"><a href="programar-ado---files.html#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p><code>marksample</code> y <code>touse</code>: Un error común es utilizar una muestra en una parte del programa y otra distinta en otra parte. La solución es crear una variable que contiene un 1 si la observación fue utilizada y un 0 en caso contrario.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb148-1"><a href="programar-ado---files.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> <span class="kw">program</span> <span class="kw">drop</span> miprograma</span>
<span id="cb148-2"><a href="programar-ado---files.html#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> miprograma</span>
<span id="cb148-3"><a href="programar-ado---files.html#cb148-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span> [<span class="kw">if</span>] [<span class="kw">in</span>] [, <span class="kw">adjust</span>(<span class="fu">real</span> 1) <span class="bn">title</span>(<span class="fu">string</span>)]</span>
<span id="cb148-4"><a href="programar-ado---files.html#cb148-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">marksample</span> touse</span>
<span id="cb148-5"><a href="programar-ado---files.html#cb148-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> </span>
<span id="cb148-6"><a href="programar-ado---files.html#cb148-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="st">&quot;`title&#39;&quot;</span> != <span class="st">&quot;&quot;</span> {</span>
<span id="cb148-7"><a href="programar-ado---files.html#cb148-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="st">&quot;`title&#39;:&quot;</span></span>
<span id="cb148-8"><a href="programar-ado---files.html#cb148-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb148-9"><a href="programar-ado---files.html#cb148-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="kw">var</span> <span class="kw">of</span> <span class="kw">local</span> <span class="kw">varlist</span>{</span>
<span id="cb148-10"><a href="programar-ado---files.html#cb148-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`var&#39;</span> <span class="ot">`if&#39;</span> <span class="ot">`touse&#39;</span></span>
<span id="cb148-11"><a href="programar-ado---files.html#cb148-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="st">&quot;`var&#39;&quot;</span> <span class="st">&quot; &quot;</span> <span class="fu">r</span>(<span class="kw">mean</span>)*<span class="ot">`adjust&#39;</span></span>
<span id="cb148-12"><a href="programar-ado---files.html#cb148-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb148-13"><a href="programar-ado---files.html#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
</div>
<div id="varlist" class="section level3 hasAnchor" number="4.0.13">
<h3><span class="header-section-number">4.0.13</span> Varlist<a href="programar-ado---files.html#varlist" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>varlist</code> específica la macro que contiene las variables que van a ingresar al programa como <em>inputs</em>. Las opciones de <code>varlist</code> son:
* <code>default = none</code>. Especifica como la <code>varlist</code> se va a llenar. Por defecto se llena con todas las variables.
* <code>min</code>, <code>max</code> especifica el número de variables permitidas.
* <code>numeric</code>, <code>string</code> especifican que criterio deben cumplir <strong>todas</strong> las variables que ingresas al programa.
* <code>ts</code> permite que la <code>varlist</code> contenga operadores de series de tiempo.
* <code>fv</code> permite que la <code>varlist</code> contenga variables categóricas.</p>
</div>
<div id="opciones" class="section level3 hasAnchor" number="4.0.14">
<h3><span class="header-section-number">4.0.14</span> Opciones<a href="programar-ado---files.html#opciones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Las opciones permiten hacer requeridos o opcionales. Por ejemplo, <code>regress, noconstant</code>. Las opciones pueden ser una <code>numlist</code>, una <code>varlist</code> (ej. <code>by(varlist) option</code>, una <code>namelist</code> tal como el nombre de una matriz o de una nueva variable. Como regla general, cualquier característica que pudieran encontrar en un comando de Stata, la pueden agregar en un programa. Para las opciones es importante recordar que las mayúsculas indican la menor abreviación posible.</p>
<ul>
<li><code>replace</code>, <code>detail</code>, <code>constant</code> son opciones de <strong>on</strong>.</li>
<li><code>noreplace</code>, <code>nodetail</code>, <code>noconstant</code> son opciones de <strong>off</strong>. Ojo las macros que retornan tienen los mismos nombres que en el caso anterior.</li>
<li><code>title</code> y <code>adjust</code> también son otros opcionales. El primero permite ingresar un título al comando mientras que el segundo permite ajustar los resultados por algún escalar.</li>
<li>Hay muchas otras. Veamos un ejemplo…</li>
</ul>
<div class="sourceCode" id="cb149"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb149-1"><a href="programar-ado---files.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> <span class="kw">program</span> <span class="kw">drop</span> miprograma</span>
<span id="cb149-2"><a href="programar-ado---files.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> miprograma</span>
<span id="cb149-3"><a href="programar-ado---files.html#cb149-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span> [<span class="kw">if</span>] [<span class="kw">in</span>] [, <span class="kw">adjust</span>(<span class="fu">real</span> 1) <span class="bn">title</span>(<span class="fu">string</span>)]</span>
<span id="cb149-4"><a href="programar-ado---files.html#cb149-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> </span>
<span id="cb149-5"><a href="programar-ado---files.html#cb149-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="st">&quot;`title&#39;&quot;</span> != <span class="st">&quot;&quot;</span> {</span>
<span id="cb149-6"><a href="programar-ado---files.html#cb149-6" aria-hidden="true" tabindex="-1"></a>        displa <span class="st">&quot;`title&#39;:&quot;</span></span>
<span id="cb149-7"><a href="programar-ado---files.html#cb149-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb149-8"><a href="programar-ado---files.html#cb149-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="kw">var</span> <span class="kw">of</span> <span class="kw">local</span> <span class="kw">varlist</span>{</span>
<span id="cb149-9"><a href="programar-ado---files.html#cb149-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`var&#39;</span> <span class="ot">`if&#39;</span> <span class="ot">`in&#39;</span></span>
<span id="cb149-10"><a href="programar-ado---files.html#cb149-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="st">&quot;`var&#39;&quot;</span> <span class="st">&quot; &quot;</span>%9.0g <span class="fu">r</span>(<span class="kw">mean</span>)*<span class="ot">`adjust&#39;</span></span>
<span id="cb149-11"><a href="programar-ado---files.html#cb149-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb149-12"><a href="programar-ado---files.html#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
</div>
<div id="programa-para-calcular-percentiles" class="section level3 hasAnchor" number="4.0.15">
<h3><span class="header-section-number">4.0.15</span> Programa para calcular percentiles<a href="programar-ado---files.html#programa-para-calcular-percentiles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una versión simple para una variable:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb150-1"><a href="programar-ado---files.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb150-2"><a href="programar-ado---files.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb150-3"><a href="programar-ado---files.html#cb150-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>)</span>
<span id="cb150-4"><a href="programar-ado---files.html#cb150-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb150-5"><a href="programar-ado---files.html#cb150-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="kw">range</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb150-6"><a href="programar-ado---files.html#cb150-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> p7525 = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb150-7"><a href="programar-ado---files.html#cb150-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> p9010 = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb150-8"><a href="programar-ado---files.html#cb150-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;&quot;</span></span>
<span id="cb150-9"><a href="programar-ado---files.html#cb150-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> p7525</span>
<span id="cb150-10"><a href="programar-ado---files.html#cb150-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> p9010 </span>
<span id="cb150-11"><a href="programar-ado---files.html#cb150-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="kw">range</span></span>
<span id="cb150-12"><a href="programar-ado---files.html#cb150-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
<p>Algunas consideraciones</p>
<ul>
<li>El programa anterior nos permite obtener los percentiles de alguna variable al mismo tiempo que los muestra en la consola.</li>
<li>Noten que también he incluido que tipo de comando es. En este caso es un comando <code>r-class</code>.</li>
<li>Los escalares definidos en el programa se pueden utilizar. Esto no siempre es conveniente.</li>
<li>Como recomendación es bueno <strong>guardar los resultados esperados de los programas como variables temporales</strong>.</li>
</ul>
<p>Versión que incluye variables guardadas localmente:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb151-1"><a href="programar-ado---files.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb151-2"><a href="programar-ado---files.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb151-3"><a href="programar-ado---files.html#cb151-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>)</span>
<span id="cb151-4"><a href="programar-ado---files.html#cb151-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> res <span class="st">&quot;range p7525 p9010&quot;</span></span>
<span id="cb151-5"><a href="programar-ado---files.html#cb151-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb151-6"><a href="programar-ado---files.html#cb151-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;&quot;</span></span>
<span id="cb151-7"><a href="programar-ado---files.html#cb151-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb151-8"><a href="programar-ado---files.html#cb151-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb151-9"><a href="programar-ado---files.html#cb151-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb151-10"><a href="programar-ado---files.html#cb151-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb151-11"><a href="programar-ado---files.html#cb151-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb151-12"><a href="programar-ado---files.html#cb151-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010&#39;</span></span>
<span id="cb151-13"><a href="programar-ado---files.html#cb151-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span></code></pre></div>
</div>
<div id="programa-con-opción-return" class="section level3 hasAnchor" number="4.0.16">
<h3><span class="header-section-number">4.0.16</span> Programa con opción return<a href="programar-ado---files.html#programa-con-opción-return" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una característica importante de los comandos de Stata es su <strong>capacidad de reportar los resultados</strong> de forma tal de que los usuarios y usuarias podamos utilizarlos posteriormente. El comando <code>return</code> nos permite guardar los escalares y hacerlos accesibles, sin tener el problema de los escalares que vimos en los ejemplos anteriores.</p>
<p>Programa para calcular percentiles con return:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb152-1"><a href="programar-ado---files.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb152-2"><a href="programar-ado---files.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb152-3"><a href="programar-ado---files.html#cb152-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>)</span>
<span id="cb152-4"><a href="programar-ado---files.html#cb152-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> res <span class="st">&quot;range p7525 p9010&quot;</span></span>
<span id="cb152-5"><a href="programar-ado---files.html#cb152-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb152-6"><a href="programar-ado---files.html#cb152-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;&quot;</span></span>
<span id="cb152-7"><a href="programar-ado---files.html#cb152-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb152-8"><a href="programar-ado---files.html#cb152-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb152-9"><a href="programar-ado---files.html#cb152-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb152-10"><a href="programar-ado---files.html#cb152-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb152-11"><a href="programar-ado---files.html#cb152-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb152-12"><a href="programar-ado---files.html#cb152-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010 &#39;</span></span>
<span id="cb152-13"><a href="programar-ado---files.html#cb152-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span>
<span id="cb152-14"><a href="programar-ado---files.html#cb152-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="fu">r</span> <span class="kw">of</span> <span class="kw">local</span> res {</span>
<span id="cb152-15"><a href="programar-ado---files.html#cb152-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="fu">scalar</span> <span class="ot">`r&#39;</span> = <span class="ot">``r&#39;</span>&#39;</span>
<span id="cb152-16"><a href="programar-ado---files.html#cb152-16" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb152-17"><a href="programar-ado---files.html#cb152-17" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
<p>Sobre la forma en que llamamos a return:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb153-1"><a href="programar-ado---files.html#cb153-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="fu">r</span> <span class="kw">of</span> <span class="kw">local</span> res {</span>
<span id="cb153-2"><a href="programar-ado---files.html#cb153-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="fu">scalar</span> <span class="ot">`r&#39;</span> = <span class="ot">``r&#39;</span>&#39;</span>
<span id="cb153-3"><a href="programar-ado---files.html#cb153-3" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<p>Notar que el lado izquierdo de <code>scalar('r')</code> se refiere al nombre de los elementos de la macro <code>res</code>. El lado derecho hace referencia a la macro una vez más para extraer el valor almacenado en ese nombre. En este caso es importante notar que se deben utilizar dos comillas (ej. <code>"range"</code>). Noten también que si utilizamos <code>scalar list</code> no hay resultados, sin embargo, al utilizar la opción <strong>return</strong> ahora podemos rescatar los resultados con <code>return list</code>.</p>
<div class="alert alert-block alert-warning">
<p><b>Ejercicio 3.6.3: </b></p>
<p>Preguntas</p>
<ol style="list-style-type: decimal">
<li>Escriba un programa llamado <code>misuma</code> que sea del tipo <code>r-class</code>.</li>
<li>Este programa debe entregar en la lista de <code>return list</code> el número total de observaciones, la suma total y el promedio de la variable.</li>
<li>Aplicarla en <code>auto.dta</code>.</li>
</ol>
</div>
</div>
<div id="agregar-opciones-al-programa" class="section level3 hasAnchor" number="4.0.17">
<h3><span class="header-section-number">4.0.17</span> Agregar opciones al programa<a href="programar-ado---files.html#agregar-opciones-al-programa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Podemos agregar distintas opciones al programa. Para este ejemplo vamos a agregar como opcional que el programa de un resultado en la consola. Recordemos que incluir <span class="math inline">\([ ]\)</span> en <code>syntax</code> significa un componente <strong>opcional</strong> en el comando.</p>
<p>Implementar opciones al programa (imprimir por defecto):</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb154-1"><a href="programar-ado---files.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb154-2"><a href="programar-ado---files.html#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb154-3"><a href="programar-ado---files.html#cb154-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>) [, PRINT]</span>
<span id="cb154-4"><a href="programar-ado---files.html#cb154-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> res <span class="st">&quot;range p7525 p9010&quot;</span></span>
<span id="cb154-5"><a href="programar-ado---files.html#cb154-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb154-6"><a href="programar-ado---files.html#cb154-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;&quot;</span></span>
<span id="cb154-7"><a href="programar-ado---files.html#cb154-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb154-8"><a href="programar-ado---files.html#cb154-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb154-9"><a href="programar-ado---files.html#cb154-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb154-10"><a href="programar-ado---files.html#cb154-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb154-11"><a href="programar-ado---files.html#cb154-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="st">&quot;`print&#39;&quot;</span> == <span class="st">&quot;print&quot;</span> {</span>
<span id="cb154-12"><a href="programar-ado---files.html#cb154-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb154-13"><a href="programar-ado---files.html#cb154-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010 &#39;</span></span>
<span id="cb154-14"><a href="programar-ado---files.html#cb154-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span>
<span id="cb154-15"><a href="programar-ado---files.html#cb154-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb154-16"><a href="programar-ado---files.html#cb154-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="fu">r</span> <span class="kw">of</span> <span class="kw">local</span> res {</span>
<span id="cb154-17"><a href="programar-ado---files.html#cb154-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="fu">scalar</span> <span class="ot">`r&#39;</span> = <span class="ot">``r&#39;</span>&#39;</span>
<span id="cb154-18"><a href="programar-ado---files.html#cb154-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb154-19"><a href="programar-ado---files.html#cb154-19" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
<p>Implementar opciones al programa (no imprimir por defecto):</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb155-1"><a href="programar-ado---files.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb155-2"><a href="programar-ado---files.html#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb155-3"><a href="programar-ado---files.html#cb155-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>) [, noPRINT]</span>
<span id="cb155-4"><a href="programar-ado---files.html#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> res <span class="st">&quot;range p7525 p9010&quot;</span></span>
<span id="cb155-5"><a href="programar-ado---files.html#cb155-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb155-6"><a href="programar-ado---files.html#cb155-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;&quot;</span></span>
<span id="cb155-7"><a href="programar-ado---files.html#cb155-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb155-8"><a href="programar-ado---files.html#cb155-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb155-9"><a href="programar-ado---files.html#cb155-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb155-10"><a href="programar-ado---files.html#cb155-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb155-11"><a href="programar-ado---files.html#cb155-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="st">&quot;`print&#39;&quot;</span> != <span class="st">&quot;noprint&quot;</span> {</span>
<span id="cb155-12"><a href="programar-ado---files.html#cb155-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb155-13"><a href="programar-ado---files.html#cb155-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010 &#39;</span></span>
<span id="cb155-14"><a href="programar-ado---files.html#cb155-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span>
<span id="cb155-15"><a href="programar-ado---files.html#cb155-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb155-16"><a href="programar-ado---files.html#cb155-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="fu">r</span> <span class="kw">of</span> <span class="kw">local</span> res {</span>
<span id="cb155-17"><a href="programar-ado---files.html#cb155-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="fu">scalar</span> <span class="ot">`r&#39;</span> = <span class="ot">``r&#39;</span>&#39;</span>
<span id="cb155-18"><a href="programar-ado---files.html#cb155-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb155-19"><a href="programar-ado---files.html#cb155-19" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
<p>Incluir un subconjunto de observaciones</p>
<ul>
<li>Cualquier comando debiese incluir <code>if</code> o <code>in range</code>.</li>
<li>Nuevamente, estas opciones son manejadas dentro del comando <code>syntax</code>. Para incluir estas opciones hay que agregar <code>[if]</code> y <code>[in]</code>.</li>
<li>Con estos comandos puedo ejecutar el programa para sub-muestras. Es importante asegurar que la sub-muestra no este vacía.</li>
<li>Para ello es importante calcular <code>r(N)</code>, chequear que sea distinto de cero y agregar un título que lo indique.</li>
<li>El comando <code>marksample touse</code> utiliza la información provista por <code>if</code> o <code>in</code> en caso de que estos sean indicados en el programa.</li>
<li>Este comando genera una variable local <code>touse</code> que es igual a 1 si las variables entran en el calculo que hace el programa y 0 en caso contrario.</li>
<li>Utilizaremos `<code>touse'</code> para calcular el número de observaciones que se utilizan después de aplicar los condicionales.</li>
<li>Es necesario agregar `<code>touse'</code> en cada parte del programa que trabaje con la variable de <em>input</em>.</li>
</ul>
<p>Incluir un subconjunto de observaciones:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb156-1"><a href="programar-ado---files.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span> </span>
<span id="cb156-2"><a href="programar-ado---files.html#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass </span>
<span id="cb156-3"><a href="programar-ado---files.html#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">max</span> = 1 <span class="kw">numeric</span>) [<span class="kw">if</span>] [<span class="kw">in</span>] [, noPRINT]</span>
<span id="cb156-4"><a href="programar-ado---files.html#cb156-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">marksample</span> touse </span>
<span id="cb156-5"><a href="programar-ado---files.html#cb156-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="fu">count</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span></span>
<span id="cb156-6"><a href="programar-ado---files.html#cb156-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="ot">`r(N)&#39;</span> == 0 {</span>
<span id="cb156-7"><a href="programar-ado---files.html#cb156-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">error</span> 2000</span>
<span id="cb156-8"><a href="programar-ado---files.html#cb156-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb156-9"><a href="programar-ado---files.html#cb156-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> res <span class="kw">range</span> p7525 p9010</span>
<span id="cb156-10"><a href="programar-ado---files.html#cb156-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb156-11"><a href="programar-ado---files.html#cb156-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb156-12"><a href="programar-ado---files.html#cb156-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb156-13"><a href="programar-ado---files.html#cb156-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb156-14"><a href="programar-ado---files.html#cb156-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb156-15"><a href="programar-ado---files.html#cb156-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb156-16"><a href="programar-ado---files.html#cb156-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="st">&quot;`print&#39;&quot;</span> != <span class="st">&quot;noprint&quot;</span> {</span>
<span id="cb156-17"><a href="programar-ado---files.html#cb156-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;, N = `r(N)&#39;&quot;</span></span>
<span id="cb156-18"><a href="programar-ado---files.html#cb156-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb156-19"><a href="programar-ado---files.html#cb156-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010 &#39;</span></span>
<span id="cb156-20"><a href="programar-ado---files.html#cb156-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span>
<span id="cb156-21"><a href="programar-ado---files.html#cb156-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb156-22"><a href="programar-ado---files.html#cb156-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> <span class="fu">r</span> <span class="kw">of</span> <span class="kw">local</span> res {</span>
<span id="cb156-23"><a href="programar-ado---files.html#cb156-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="fu">scalar</span> <span class="ot">`r&#39;</span> = <span class="ot">``r&#39;</span>&#39;</span>
<span id="cb156-24"><a href="programar-ado---files.html#cb156-24" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb156-25"><a href="programar-ado---files.html#cb156-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> <span class="fu">scalar</span> <span class="kw">N</span> = <span class="fu">r</span>(<span class="kw">N</span>)</span>
<span id="cb156-26"><a href="programar-ado---files.html#cb156-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> <span class="kw">local</span> varname <span class="ot">`varlist&#39;</span></span>
<span id="cb156-27"><a href="programar-ado---files.html#cb156-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-28"><a href="programar-ado---files.html#cb156-28" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code></pre></div>
<div class="alert alert-block alert-warning">
<p><b>Ejercicio 3.6.2: </b></p>
<p>Preguntas</p>
<ol style="list-style-type: decimal">
<li>Ajuste el programa del ejercicio 1 con el fin de incluir la opción <code>if</code>. Guárdelo como <code>misuma2</code>.</li>
<li>Aplicarla en <code>auto.dta</code>.</li>
</ol>
</div>
</div>
<div id="generalizar-el-comando-para-incluir-múltiples-variables-1" class="section level3 hasAnchor" number="4.0.18">
<h3><span class="header-section-number">4.0.18</span> Generalizar el comando para incluir múltiples variables<a href="programar-ado---files.html#generalizar-el-comando-para-incluir-múltiples-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Algunas consideraciones</p>
<ul>
<li>Si quiero ejecutar el programa sobre múltiples variables, es necesario ajustar un poco el programa.</li>
<li>Tengo que indicarle a <code>syntax</code> que hay más de una variable. Además, tengo que indicarle al programa que en caso de que existan más variables muestre los resultados en una tabla.</li>
<li>Guardaremos los resultados en matrices (no escalares) y vamos a aplicar una <strong>función de macro extendida</strong> con el fin de contar el número de filas que esta matriz debiese tener.</li>
<li>Agregaremos también una la opción <code>format</code> para cambiar el formato y la opción <code>mat</code> que permite a la matriz ser guardada automáticamente con el nombre indicado.</li>
</ul>
<div class="sourceCode" id="cb157"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb157-1"><a href="programar-ado---files.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span> </span>
<span id="cb157-2"><a href="programar-ado---files.html#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass</span>
<span id="cb157-3"><a href="programar-ado---files.html#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17 </span>
<span id="cb157-4"><a href="programar-ado---files.html#cb157-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">min</span> = 1 <span class="kw">numeric</span> ts) [<span class="kw">if</span>] [<span class="kw">in</span>] [, noPRINT FORmat(passthru) MATrix(<span class="fu">string</span>)] </span>
<span id="cb157-5"><a href="programar-ado---files.html#cb157-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">marksample</span> touse </span>
<span id="cb157-6"><a href="programar-ado---files.html#cb157-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="fu">count</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span></span>
<span id="cb157-7"><a href="programar-ado---files.html#cb157-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="ot">`r(N)&#39;</span> == 0 {</span>
<span id="cb157-8"><a href="programar-ado---files.html#cb157-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">error</span> 2000</span>
<span id="cb157-9"><a href="programar-ado---files.html#cb157-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb157-10"><a href="programar-ado---files.html#cb157-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> nvar: <span class="fu">word</span> <span class="fu">count</span> <span class="ot">`varlist&#39;</span></span>
<span id="cb157-11"><a href="programar-ado---files.html#cb157-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="ot">`nvar&#39;</span> == 1 {</span>
<span id="cb157-12"><a href="programar-ado---files.html#cb157-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">local</span> res <span class="kw">range</span> p7525 p9010</span>
<span id="cb157-13"><a href="programar-ado---files.html#cb157-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">tempname</span> <span class="ot">`res&#39;</span>    </span>
<span id="cb157-14"><a href="programar-ado---files.html#cb157-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb157-15"><a href="programar-ado---files.html#cb157-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`varlist&#39;</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb157-16"><a href="programar-ado---files.html#cb157-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scalar</span> <span class="ot">`range&#39;</span> = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb157-17"><a href="programar-ado---files.html#cb157-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scalar</span> <span class="ot">`p7525&#39;</span> = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb157-18"><a href="programar-ado---files.html#cb157-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scalar</span> <span class="ot">`p9010&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb157-19"><a href="programar-ado---files.html#cb157-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="st">&quot;`print&#39;&quot;</span> != <span class="st">&quot;noprint&quot;</span> {</span>
<span id="cb157-20"><a href="programar-ado---files.html#cb157-20" aria-hidden="true" tabindex="-1"></a>            <span class="kw">display</span> <span class="kw">as</span> result <span class="dt">_n</span> <span class="st">&quot;Rangos de percentiles para `varlist&#39;, N = `r(N)&#39;&quot;</span></span>
<span id="cb157-21"><a href="programar-ado---files.html#cb157-21" aria-hidden="true" tabindex="-1"></a>            <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;75-25 : &quot;</span> <span class="ot">`p7525&#39;</span></span>
<span id="cb157-22"><a href="programar-ado---files.html#cb157-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;90-10:  &quot;</span> <span class="ot">`p9010 &#39;</span></span>
<span id="cb157-23"><a href="programar-ado---files.html#cb157-23" aria-hidden="true" tabindex="-1"></a>            <span class="kw">display</span> <span class="kw">as</span> txt <span class="st">&quot;Range: &quot;</span> <span class="ot">`range&#39;</span></span>
<span id="cb157-24"><a href="programar-ado---files.html#cb157-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb157-25"><a href="programar-ado---files.html#cb157-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreach</span> <span class="fu">r</span> <span class="kw">of</span> <span class="kw">local</span> res {</span>
<span id="cb157-26"><a href="programar-ado---files.html#cb157-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="fu">scalar</span> <span class="ot">`r&#39;</span> = <span class="ot">``r&#39;</span>&#39;</span>
<span id="cb157-27"><a href="programar-ado---files.html#cb157-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb157-28"><a href="programar-ado---files.html#cb157-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> <span class="fu">scalar</span> <span class="kw">N</span> = <span class="fu">r</span>(<span class="kw">N</span>)</span>
<span id="cb157-29"><a href="programar-ado---files.html#cb157-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb157-30"><a href="programar-ado---files.html#cb157-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">else</span> {</span>
<span id="cb157-31"><a href="programar-ado---files.html#cb157-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempname</span> rmat </span>
<span id="cb157-32"><a href="programar-ado---files.html#cb157-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span> <span class="ot">`rmat&#39;</span> = <span class="fu">J</span>(<span class="ot">`nvar&#39;</span>, 3, .)</span>
<span id="cb157-33"><a href="programar-ado---files.html#cb157-33" aria-hidden="true" tabindex="-1"></a>      <span class="kw">local</span> i 0 </span>
<span id="cb157-34"><a href="programar-ado---files.html#cb157-34" aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreach</span> v <span class="kw">of</span> <span class="kw">varlist</span> <span class="ot">`varlist&#39;</span>{</span>
<span id="cb157-35"><a href="programar-ado---files.html#cb157-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">local</span> ++i </span>
<span id="cb157-36"><a href="programar-ado---files.html#cb157-36" aria-hidden="true" tabindex="-1"></a>        <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`v&#39;</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb157-37"><a href="programar-ado---files.html#cb157-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">matrix</span> <span class="ot">`rmat&#39;</span>[<span class="ot">`i&#39;</span> ,1] = <span class="fu">r</span>(<span class="fu">max</span>) - <span class="fu">r</span>(<span class="fu">min</span>)</span>
<span id="cb157-38"><a href="programar-ado---files.html#cb157-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">matrix</span> <span class="ot">`rmat&#39;</span>[<span class="ot">`i&#39;</span>, 2] = <span class="fu">r</span>(p75) - <span class="fu">r</span>(p25)</span>
<span id="cb157-39"><a href="programar-ado---files.html#cb157-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">matrix</span> <span class="ot">`rmat&#39;</span>[<span class="ot">`i&#39;</span>, 3] = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10)</span>
<span id="cb157-40"><a href="programar-ado---files.html#cb157-40" aria-hidden="true" tabindex="-1"></a>        <span class="kw">local</span> <span class="ot">rown</span> <span class="ot">`rown&#39;</span> <span class="ot">`v&#39;</span></span>
<span id="cb157-41"><a href="programar-ado---files.html#cb157-41" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb157-42"><a href="programar-ado---files.html#cb157-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span> <span class="ot">colnames</span> <span class="ot">`rmat&#39;</span> = Range P75-P25 P90-P10 </span>
<span id="cb157-43"><a href="programar-ado---files.html#cb157-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span> <span class="ot">rownames</span> <span class="ot">`rmat&#39;</span> = <span class="ot">`rown&#39;</span> </span>
<span id="cb157-44"><a href="programar-ado---files.html#cb157-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-45"><a href="programar-ado---files.html#cb157-45" aria-hidden="true" tabindex="-1"></a>      <span class="kw">if</span> <span class="st">&quot;`print&#39;&quot;</span> != <span class="st">&quot;noprint&quot;</span> {</span>
<span id="cb157-46"><a href="programar-ado---files.html#cb157-46" aria-hidden="true" tabindex="-1"></a>          <span class="kw">local</span> form <span class="st">&quot;, noheader&quot;</span></span>
<span id="cb157-47"><a href="programar-ado---files.html#cb157-47" aria-hidden="true" tabindex="-1"></a>          <span class="kw">if</span> <span class="st">&quot;`format&#39;&quot;</span> != <span class="st">&quot;&quot;</span> {</span>
<span id="cb157-48"><a href="programar-ado---files.html#cb157-48" aria-hidden="true" tabindex="-1"></a>                <span class="kw">local</span> form <span class="st">&quot;`form&#39; `format&#39;&quot;</span> </span>
<span id="cb157-49"><a href="programar-ado---files.html#cb157-49" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb157-50"><a href="programar-ado---files.html#cb157-50" aria-hidden="true" tabindex="-1"></a>          <span class="fu">matrix</span> <span class="ot">list</span> <span class="ot">`rmat&#39;</span> <span class="ot">`form&#39;</span></span>
<span id="cb157-51"><a href="programar-ado---files.html#cb157-51" aria-hidden="true" tabindex="-1"></a>                                }</span>
<span id="cb157-52"><a href="programar-ado---files.html#cb157-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-53"><a href="programar-ado---files.html#cb157-53" aria-hidden="true" tabindex="-1"></a>      <span class="kw">if</span> <span class="st">&quot;`matrix&#39;&quot;</span> != <span class="st">&quot;&quot;</span> {</span>
<span id="cb157-54"><a href="programar-ado---files.html#cb157-54" aria-hidden="true" tabindex="-1"></a>            <span class="fu">matrix</span> <span class="ot">`matrix&#39;</span> = <span class="ot">`rmat&#39;</span></span>
<span id="cb157-55"><a href="programar-ado---files.html#cb157-55" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb157-56"><a href="programar-ado---files.html#cb157-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span> <span class="fu">matrix</span> rmat = <span class="ot">`rmat&#39;</span></span>
<span id="cb157-57"><a href="programar-ado---files.html#cb157-57" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb157-58"><a href="programar-ado---files.html#cb157-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span> <span class="kw">local</span> varname <span class="ot">`varlist&#39;</span></span>
<span id="cb157-59"><a href="programar-ado---files.html#cb157-59" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
</div>
<div id="agregar-prefijos-a-los-programas-1" class="section level3 hasAnchor" number="4.0.19">
<h3><span class="header-section-number">4.0.19</span> Agregar prefijos a los programas<a href="programar-ado---files.html#agregar-prefijos-a-los-programas-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>prefijo by: Ahora vamos a hacer que nuestro programa pueda utilizar el prefijo <code>by</code>. Para agregar esta opción simplemente hay que modificar <code>program</code>.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb158-1"><a href="programar-ado---files.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> pctrange, rclass byable(recall)</span></code></pre></div>
<p>También podemos permitir que la lista de variables incluya <strong>operadores de series de tiempo</strong> (ej. <code>L.pib</code>, <code>D.ingreso</code>).</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb159-1"><a href="programar-ado---files.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> <span class="kw">varlist</span>(<span class="fu">min</span> = 1 <span class="kw">numeric</span> ts) </span></code></pre></div>
</div>
<div id="programas-para-complementar-función-egen-1" class="section level3 hasAnchor" number="4.0.20">
<h3><span class="header-section-number">4.0.20</span> Programas para complementar función egen<a href="programar-ado---files.html#programas-para-complementar-función-egen-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Es posible programar funciones adicionales de <code>egen</code> (<em>extended generate</em>). El nombre de estos programas deben empezar con <code>_g</code>. Una diferencia entre este tipo de programas y los ya hechos es que en estos hay que tener en cuenta la nueva variable que se va a crear. La sintaxis es la siguiente:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb160-1"><a href="programar-ado---files.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> [<span class="dv">type</span>] newvarname = fcn(arguments) [<span class="kw">if</span>] [<span class="kw">in</span>] [, options]</span></code></pre></div>
<p>El cambio que vamos a hacer en la sintaxis del programa será que incluiremos un <code>touse</code> para hacer la nueva variable.</p>
<p>Vamos a escribir un programa para calcular un rango en particular:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb161-1"><a href="programar-ado---files.html#cb161-1" aria-hidden="true" tabindex="-1"></a>* Programas <span class="kw">de</span> <span class="kw">egen</span> </span>
<span id="cb161-2"><a href="programar-ado---files.html#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span></span>
<span id="cb161-3"><a href="programar-ado---files.html#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> _gpct9010</span>
<span id="cb161-4"><a href="programar-ado---files.html#cb161-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">syntax</span> newvarname =/<span class="fu">exp</span> [<span class="kw">if</span>] [<span class="kw">in</span>] </span>
<span id="cb161-5"><a href="programar-ado---files.html#cb161-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tempvar</span> touse </span>
<span id="cb161-6"><a href="programar-ado---files.html#cb161-6" aria-hidden="true" tabindex="-1"></a>    mark <span class="ot">`touse&#39;</span> <span class="ot">`if&#39;</span> <span class="ot">`in&#39;</span> </span>
<span id="cb161-7"><a href="programar-ado---files.html#cb161-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">summarize</span> <span class="ot">`exp&#39;</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="kw">detail</span> </span>
<span id="cb161-8"><a href="programar-ado---files.html#cb161-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quietly</span> <span class="kw">generate</span> <span class="ot">`typlist&#39;</span> <span class="ot">`varlist&#39;</span> = <span class="fu">r</span>(p90) - <span class="fu">r</span>(p10) <span class="kw">if</span> <span class="ot">`touse&#39;</span></span>
<span id="cb161-9"><a href="programar-ado---files.html#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb161-10"><a href="programar-ado---files.html#cb161-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-11"><a href="programar-ado---files.html#cb161-11" aria-hidden="true" tabindex="-1"></a>* Aplicación del programa</span>
<span id="cb161-12"><a href="programar-ado---files.html#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="kw">sysuse</span> auto, <span class="kw">clear</span></span>
<span id="cb161-13"><a href="programar-ado---files.html#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> rango9010 = pct9010(price)</span></code></pre></div>
<p>Programas con funciones de egen con prefijo by:</p>
<ul>
<li>Agregamos [, *] que corresponde a las opciones. En <code>egen</code>el prefijo <code>by</code> es una opción.</li>
<li>Con el fin de permitirle al programa que pueda producir un rango de percentil separado para distintos grupos utilizaremos <code>pctile</code> en vez de <code>summarize</code>.</li>
</ul>
<div class="sourceCode" id="cb162"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb162-1"><a href="programar-ado---files.html#cb162-1" aria-hidden="true" tabindex="-1"></a>* Programa con opción <span class="kw">by</span>. </span>
<span id="cb162-2"><a href="programar-ado---files.html#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span></span>
<span id="cb162-3"><a href="programar-ado---files.html#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> _gpct9010</span>
<span id="cb162-4"><a href="programar-ado---files.html#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> newvarname =/<span class="fu">exp</span> [<span class="kw">if</span>] [<span class="kw">in</span>] [, *] </span>
<span id="cb162-5"><a href="programar-ado---files.html#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="kw">tempvar</span> touse p90 p10 </span>
<span id="cb162-6"><a href="programar-ado---files.html#cb162-6" aria-hidden="true" tabindex="-1"></a>mark <span class="ot">`touse&#39;</span> <span class="ot">`if&#39;</span> <span class="ot">`in&#39;</span> </span>
<span id="cb162-7"><a href="programar-ado---files.html#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="kw">quietly</span> {</span>
<span id="cb162-8"><a href="programar-ado---files.html#cb162-8" aria-hidden="true" tabindex="-1"></a>          <span class="kw">egen</span> <span class="kw">double</span> <span class="ot">`p90&#39;</span> = <span class="kw">pctile</span>(<span class="ot">`exp&#39;</span>) <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="ot">`options&#39;</span> <span class="kw">p</span>(90) </span>
<span id="cb162-9"><a href="programar-ado---files.html#cb162-9" aria-hidden="true" tabindex="-1"></a>          <span class="kw">egen</span> <span class="kw">double</span> <span class="ot">`p10&#39;</span> = <span class="kw">pctile</span>(<span class="ot">`exp&#39;</span>) <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="ot">`options&#39;</span> <span class="kw">p</span>(10)</span>
<span id="cb162-10"><a href="programar-ado---files.html#cb162-10" aria-hidden="true" tabindex="-1"></a>          <span class="kw">generate</span> <span class="ot">`typlist&#39;</span> <span class="ot">`varlist&#39;</span> = <span class="ot">`p90&#39;</span> - <span class="ot">`p10&#39;</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span> } </span>
<span id="cb162-11"><a href="programar-ado---files.html#cb162-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb162-12"><a href="programar-ado---files.html#cb162-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-13"><a href="programar-ado---files.html#cb162-13" aria-hidden="true" tabindex="-1"></a>* Aplicación del programa</span>
<span id="cb162-14"><a href="programar-ado---files.html#cb162-14" aria-hidden="true" tabindex="-1"></a><span class="kw">sysuse</span> auto, <span class="kw">clear</span></span>
<span id="cb162-15"><a href="programar-ado---files.html#cb162-15" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> rango9010 = pct9010(price)</span>
<span id="cb162-16"><a href="programar-ado---files.html#cb162-16" aria-hidden="true" tabindex="-1"></a><span class="kw">bysort</span> rep78 foreign: <span class="kw">egen</span> rango9010_prefijoby = pct9010(price)</span></code></pre></div>
</div>
<div id="generalización-de-la-función-egen" class="section level3 hasAnchor" number="4.0.21">
<h3><span class="header-section-number">4.0.21</span> Generalización de la función egen<a href="programar-ado---files.html#generalización-de-la-función-egen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hemos desarrollado una función de <code>egen</code> que permite calcular un rango entre percentiles para una lista de variables especifica. Puede ser útil tomar ventaja de <code>egen pctile()</code> para poder calcular cualquier percentil de la lista de variables especificadas. Vamos a agregar dos opciones a la función <code>egen</code> : <code>lo()</code> y <code>hi()</code>. En caso de que no especifiquemos, por defecto se calcula el rango interquartil. La función de <code>egen</code> ahora se llamará <code>_gpctrange.ado</code>.</p>
<p>Función egen más general para percentiles:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb163-1"><a href="programar-ado---files.html#cb163-1" aria-hidden="true" tabindex="-1"></a>* Programa con opción <span class="kw">by</span>. </span>
<span id="cb163-2"><a href="programar-ado---files.html#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> <span class="kw">drop</span> <span class="dt">_all</span></span>
<span id="cb163-3"><a href="programar-ado---files.html#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> _gpctrange</span>
<span id="cb163-4"><a href="programar-ado---files.html#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> newvarname =/<span class="fu">exp</span> [<span class="kw">if</span>] [<span class="kw">in</span>] [, LO(integer 25) HI(integer 75) *] </span>
<span id="cb163-5"><a href="programar-ado---files.html#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="programar-ado---files.html#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ot">`hi&#39;</span> &gt; 99 | <span class="ot">`lo&#39;</span> &lt; 1 {</span>
<span id="cb163-7"><a href="programar-ado---files.html#cb163-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> <span class="kw">error</span> <span class="co">///</span></span>
<span id="cb163-8"><a href="programar-ado---files.html#cb163-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Percentiles `lo&#39; `hi&#39; deben estar entre 1 y 99.&quot;</span> </span>
<span id="cb163-9"><a href="programar-ado---files.html#cb163-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">error</span> 198 </span>
<span id="cb163-10"><a href="programar-ado---files.html#cb163-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-11"><a href="programar-ado---files.html#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ot">`hi&#39;</span> &lt;= <span class="ot">`lo&#39;</span> {</span>
<span id="cb163-12"><a href="programar-ado---files.html#cb163-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="kw">as</span> <span class="kw">error</span> <span class="co">///</span></span>
<span id="cb163-13"><a href="programar-ado---files.html#cb163-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Percentiles `lo&#39; `hi&#39; deben estar en orden ascendente&quot;</span></span>
<span id="cb163-14"><a href="programar-ado---files.html#cb163-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">error</span> 198 </span>
<span id="cb163-15"><a href="programar-ado---files.html#cb163-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-16"><a href="programar-ado---files.html#cb163-16" aria-hidden="true" tabindex="-1"></a><span class="kw">tempvar</span> touse phi plo </span>
<span id="cb163-17"><a href="programar-ado---files.html#cb163-17" aria-hidden="true" tabindex="-1"></a>mark <span class="ot">`touse&#39;</span> <span class="ot">`if&#39;</span> <span class="ot">`in&#39;</span> </span>
<span id="cb163-18"><a href="programar-ado---files.html#cb163-18" aria-hidden="true" tabindex="-1"></a><span class="kw">quietly</span> {</span>
<span id="cb163-19"><a href="programar-ado---files.html#cb163-19" aria-hidden="true" tabindex="-1"></a>          <span class="kw">egen</span> <span class="kw">double</span> <span class="ot">`phi&#39;</span> = <span class="kw">pctile</span>(<span class="ot">`exp&#39;</span>) <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="ot">`options&#39;</span> <span class="kw">p</span>(<span class="ot">`hi&#39;</span>) </span>
<span id="cb163-20"><a href="programar-ado---files.html#cb163-20" aria-hidden="true" tabindex="-1"></a>          <span class="kw">egen</span> <span class="kw">double</span> <span class="ot">`plo&#39;</span> = <span class="kw">pctile</span>(<span class="ot">`exp&#39;</span>) <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="ot">`options&#39;</span> <span class="kw">p</span>(<span class="ot">`lo&#39;</span>)</span>
<span id="cb163-21"><a href="programar-ado---files.html#cb163-21" aria-hidden="true" tabindex="-1"></a>          <span class="kw">generate</span> <span class="ot">`typlist&#39;</span> <span class="ot">`varlist&#39;</span> = <span class="ot">`phi&#39;</span> - <span class="ot">`plo&#39;</span> <span class="kw">if</span> <span class="ot">`touse&#39;</span> </span>
<span id="cb163-22"><a href="programar-ado---files.html#cb163-22" aria-hidden="true" tabindex="-1"></a>          } </span>
<span id="cb163-23"><a href="programar-ado---files.html#cb163-23" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb163-24"><a href="programar-ado---files.html#cb163-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-25"><a href="programar-ado---files.html#cb163-25" aria-hidden="true" tabindex="-1"></a><span class="kw">sysuse</span> auto, <span class="kw">clear</span></span>
<span id="cb163-26"><a href="programar-ado---files.html#cb163-26" aria-hidden="true" tabindex="-1"></a><span class="kw">bysort</span> rep78: <span class="kw">egen</span> <span class="fu">iqr</span> = pctrange(price) <span class="kw">if</span> <span class="fu">inrange</span>(rep78,3,5)</span>
<span id="cb163-27"><a href="programar-ado---files.html#cb163-27" aria-hidden="true" tabindex="-1"></a><span class="kw">bysort</span> rep78: <span class="kw">egen</span> p8020 = pctrange(price) <span class="kw">if</span> <span class="fu">inrange</span>(rep78,3,5), hi(80) lo(20)</span>
<span id="cb163-28"><a href="programar-ado---files.html#cb163-28" aria-hidden="true" tabindex="-1"></a><span class="kw">bysort</span> rep78: <span class="kw">egen</span> p8020 = pctrange(price) <span class="kw">if</span> <span class="fu">inrange</span>(rep78,3,5) <span class="co">///</span></span>
<span id="cb163-29"><a href="programar-ado---files.html#cb163-29" aria-hidden="true" tabindex="-1"></a>&amp; foreign==1, hi(80) lo(20)</span>
<span id="cb163-30"><a href="programar-ado---files.html#cb163-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-31"><a href="programar-ado---files.html#cb163-31" aria-hidden="true" tabindex="-1"></a>* Utilizar estas nuevas variables con otros comandos</span>
<span id="cb163-32"><a href="programar-ado---files.html#cb163-32" aria-hidden="true" tabindex="-1"></a><span class="kw">tabstat</span> <span class="fu">iqr</span> <span class="kw">if</span> <span class="fu">inrange</span>(rep78, 3, 5), <span class="kw">by</span>(rep78)</span>
<span id="cb163-33"><a href="programar-ado---files.html#cb163-33" aria-hidden="true" tabindex="-1"></a><span class="kw">tabstat</span> p8020 <span class="kw">if</span> <span class="fu">inrange</span>(rep78, 3, 5), <span class="kw">by</span>(rep78)</span></code></pre></div>
</div>
<div id="documentar-tu-programa" class="section level3 hasAnchor" number="4.0.22">
<h3><span class="header-section-number">4.0.22</span> Documentar tu programa<a href="programar-ado---files.html#documentar-tu-programa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Escribir un help</p>
<ul>
<li>Es necesario y recomendado mantener una documentación de los programas que se escriban para un proyecto.</li>
<li>Esta documentación debe estar actualizada e incluir cualquier modificación. <strong>Importante hacerlo mientras se hace el programa y no al final</strong>.</li>
<li>Vamos a aprender un poco de SMCL (<em>Stata Markup and Control Language file</em>). Básicamente es el lenguaje con el que se escriben los <code>help</code> en Stata. También es el lenguaje con el que se muestran los resultados de <code>display</code>.</li>
<li>Los archivos se pueden escribir en cualquier procesador de texto, pero deben ser guardados en formato <code>.smcl</code>. También deben ser guardados en la misma carpeta en donde se encuentra el <code>ado-file</code> relacionado con el archivo.</li>
<li>Hay que empezar los códigos con <span class="math inline">\(\{smcl\}\)</span> con el fin de indicarle a Stata que el texto que viene será en formato SMCL.</li>
<li>Las etiquetas de SMCL van entre llaves (<span class="math inline">\(\{\}\)</span>) y se pueden leer de dos formas principalmente:
<ul>
<li><span class="math inline">\(\{tag:text\}\)</span> etiquetar el texto que se esta escribiendo.</li>
<li><span class="math inline">\(\{tag\}\)</span> etiquetar todo lo que viene hasta que se cambie en otra parte del texto.</li>
</ul></li>
</ul>
<p>Por ejemplo, si quiero poner texto en <em>itálica</em> tengo que ocupar la <strong>etiqueta</strong> <em>it</em>:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb164-1"><a href="programar-ado---files.html#cb164-1" aria-hidden="true" tabindex="-1"></a>* Una palabra/frase en particular</span>
<span id="cb164-2"><a href="programar-ado---files.html#cb164-2" aria-hidden="true" tabindex="-1"></a>{it:este texto aparecerá en itálica}</span>
<span id="cb164-3"><a href="programar-ado---files.html#cb164-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-4"><a href="programar-ado---files.html#cb164-4" aria-hidden="true" tabindex="-1"></a>* Todo <span class="fu">el</span> bloque <span class="kw">de</span> texto</span>
<span id="cb164-5"><a href="programar-ado---files.html#cb164-5" aria-hidden="true" tabindex="-1"></a>{it} Todo lo que este aquí aparecerá en itálica. <span class="co">///</span></span>
<span id="cb164-6"><a href="programar-ado---files.html#cb164-6" aria-hidden="true" tabindex="-1"></a>Esto va a ocurrir hasta que aparezca un nuevo <span class="co">///</span></span>
<span id="cb164-7"><a href="programar-ado---files.html#cb164-7" aria-hidden="true" tabindex="-1"></a>tipo <span class="kw">de</span> etiqueta. </span></code></pre></div>
<p>Etiquetas de SMCL</p>
<ul>
<li><strong>Texto:</strong> {it}, {bf}, {sf}, {ul}. Itálica, negrita, texto normal, subrayado, repectivamente.</li>
<li><strong>Texto en formato Stata:</strong> {cmd}, {error}, {result}, {text}.</li>
<li><strong>{Destacar una referencia:</strong> {hi}.</li>
<li><strong>Opciones de comando:</strong> {opt}.</li>
<li><strong>Insertar linea horizontal:</strong> {hline}.</li>
<li><strong>Volver a dejar el texto a su estado normal:</strong> {reset}.</li>
<li><strong>Formato de documento:</strong> {title:text}, {center}, {ralign}, {lalign}, {tab}.</li>
<li><strong>Párrafos:</strong> Hay dos opciones para escribirlos.
<ul>
<li>{p #1 #2 #3 #4}.<br />
</li>
<li>{p} = {p 0 0 0 0}</li>
</ul></li>
<li>Los números indican los siguientes elementos de un párrafo:
<ul>
<li>El primer número (#1) es cuántos caracteres hay que sangrar en la primera línea.</li>
<li>El segundo número (#2) es cuántos caracteres hay que sangrar en la segunda y tercera línea.</li>
<li>El tercer número (#3) es cuán lejos de la derecha debe estar el margen.</li>
<li>El cuarto número (#4) es para el ancho total del párrafo.</li>
<li>{phang}: es equivalente a {p 4 8 2}.</li>
<li>{pstd}: es equivalente a {p 4 4 2}.</li>
<li>{phang2}: es equivalente a {p 8 12 2}.</li>
<li>{p2col}: Para separar el texto en dos columnas.</li>
<li>{p_end}: Para terminar un párrafo. Útil cuando tienes dos parrafos en formatos distintos.</li>
</ul></li>
</ul>
</div>
<div id="escribir-programas-e-class" class="section level3 hasAnchor" number="4.0.23">
<h3><span class="header-section-number">4.0.23</span> Escribir programas e-class<a href="programar-ado---files.html#escribir-programas-e-class" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vamos a aprender algunos elementos que nos van a permitir escribir nuestros propios comandos de estimación en Stata. Muchos de los conceptos que hemos visto aplican también para este tipo de comandos. Es necesario recordar algunas convenciones que nos van a ser útiles para poder escribir nuestros programas.</p>
<ul>
<li>Los resultados se guardan en <code>|e()</code> y se puede acceder a ellos con <code>ereturn list</code>.</li>
<li>El número de observaciones es <code>e(N)</code> y para identificar que observaciones fueron incluidas en la estimación es necesario utilizar la función <code>e(sample)</code>.</li>
<li>Los coeficientes estimados se guardan en un vector <code>e(b)</code> y la matriz de varianza covarianza se guarda en <code>e(V)</code>.</li>
<li>El comando <code>ereturn name = exp</code> retorna un escalar, mientras que <code>ereturn local name value</code> y <code>ereturn matrix name matname</code> retorna una macro y una matriz respectivamente.</li>
<li>El comando <code>ereturn post</code> envía las estimaciones de <code>b</code> y <code>V</code> a sus ubicaciones oficiales.</li>
<li>Para devolver el vector de coeficientes y su matriz de varianza, es necesario crear el vector de coeficientes, digamos <span class="math inline">\(beta\)</span>, y su matriz de varianza-covarianza, digamos <span class="math inline">\(vce\)</span>.</li>
</ul>
<div class="sourceCode" id="cb165"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb165-1"><a href="programar-ado---files.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ereturn</span> <span class="kw">post</span> <span class="ot">`beta&#39;</span> &#39;vce&#39;, <span class="kw">esample</span>(<span class="ot">`touse&#39;</span>)</span></code></pre></div>
<p>También podemos definir la muestra de estimación incluida en la estimación con <code>touse</code>. Ahora es posible guardar los elementos en <code>e()</code>. Por ejemplo, es posible utilizar <code>ereturn scalar</code>, <code>ereturn local</code> o <code>ereturn matrix</code>.</p>
<p>Es conveniente utilizar los nombres típicamente asignados para guardar resultados de los programas <code>e(df_m)</code> o <code>e(df_r)</code>. Sin embargo, se pueden nombrar como deseen.</p>
</div>
<div id="marksample-mark-y-markout" class="section level3 hasAnchor" number="4.0.24">
<h3><span class="header-section-number">4.0.24</span> Marksample, Mark y Markout<a href="programar-ado---files.html#marksample-mark-y-markout" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>marksample</code> y <code>mark</code> son alternativas. <code>mark</code> no es muy utilizado. Ambos comandos crean un indicador que marcan que observaciones será utilizadas. Los ocupadmos en los programas en Stata. La idea es indicarle al programa la muestra relevante. <code>markout</code> marca la variable con un indicador igual a 0 si cualquier variable en <code>varlist</code> indicada contiene un <em>missing</em>.</p>
<p>Marksample</p>
<ul>
<li><code>marksample</code> se utiliza en programas en los que los argumentos se analizan mediante el comando <code>syntax</code>.</li>
<li>Crea una variable temporal, almacena el nombre de la variable temporal en un local, y rellena la variable temporal con 0 y 1 según si la observación debe ser utilizada.</li>
</ul>
<div class="sourceCode" id="cb166"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb166-1"><a href="programar-ado---files.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> ....</span>
<span id="cb166-2"><a href="programar-ado---files.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> ...</span>
<span id="cb166-3"><a href="programar-ado---files.html#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="kw">marksample</span> touse</span>
<span id="cb166-4"><a href="programar-ado---files.html#cb166-4" aria-hidden="true" tabindex="-1"></a>rest <span class="kw">of</span> code .... <span class="kw">if</span> <span class="ot">`touse&#39;</span></span>
<span id="cb166-5"><a href="programar-ado---files.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p>Mark</p>
<ul>
<li><code>mark</code> utiliza la variable temporal <code>touse</code> basada en las expresiones de <code>if</code> e <code>in</code>.</li>
<li>Si no hay expresiones de <code>if</code> e <code>in</code>, <code>touse</code> será 1 para cada observación en los datos.</li>
<li>Si indico una condición, solo las observaciones que cumplan esta condición tendrán un 1 en <code>touse</code>.</li>
<li><code>Mark</code> actualiza <code>touse</code> de forma tal de que revisa <em>missing</em>.</li>
</ul>
<p>Mark y Markout</p>
<ul>
<li><code>mark</code> parte con una variable temporal previamente creada.<br />
</li>
<li><code>markout</code> modifica la variable creada por <code>mark</code> poniéndola a cero en las observaciones que tienen valores perdidos registrados para cualquiera de las variables en <em>varlist</em>.</li>
</ul>
<div class="sourceCode" id="cb167"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb167-1"><a href="programar-ado---files.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> ....</span>
<span id="cb167-2"><a href="programar-ado---files.html#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="kw">tempvar</span> touse</span>
<span id="cb167-3"><a href="programar-ado---files.html#cb167-3" aria-hidden="true" tabindex="-1"></a>mark <span class="ot">`touse&#39;</span> ...</span>
<span id="cb167-4"><a href="programar-ado---files.html#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="kw">markout</span> <span class="ot">`touse&#39;</span> ...</span>
<span id="cb167-5"><a href="programar-ado---files.html#cb167-5" aria-hidden="true" tabindex="-1"></a>rest <span class="kw">of</span> code ... <span class="kw">if</span> <span class="ot">`touse&#39;</span></span>
<span id="cb167-6"><a href="programar-ado---files.html#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p>Marksample vs. Markout</p>
<ul>
<li><code>marksample</code> es mejor que <code>mark</code>. Disminuye la probabilidad de que se olvide alguna restricción.</li>
<li><code>markout</code> puede ser utilizados después de <code>mark</code> o bien <code>marksample</code>.</li>
</ul>
<div class="sourceCode" id="cb168"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb168-1"><a href="programar-ado---files.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> ...</span>
<span id="cb168-2"><a href="programar-ado---files.html#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="kw">tempvar</span> touse</span>
<span id="cb168-3"><a href="programar-ado---files.html#cb168-3" aria-hidden="true" tabindex="-1"></a>mark <span class="ot">`touse&#39;</span> ...</span>
<span id="cb168-4"><a href="programar-ado---files.html#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="kw">markout</span> <span class="ot">`touse&#39;</span> ...</span>
<span id="cb168-5"><a href="programar-ado---files.html#cb168-5" aria-hidden="true" tabindex="-1"></a>rest <span class="kw">of</span> code ... <span class="kw">if</span> <span class="ot">`touse&#39;</span></span>
<span id="cb168-6"><a href="programar-ado---files.html#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb168-7"><a href="programar-ado---files.html#cb168-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-8"><a href="programar-ado---files.html#cb168-8" aria-hidden="true" tabindex="-1"></a>prgraom myprog</span>
<span id="cb168-9"><a href="programar-ado---files.html#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> <span class="kw">varlist</span> [<span class="kw">if</span>] [<span class="kw">in</span>]</span>
<span id="cb168-10"><a href="programar-ado---files.html#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="kw">marksample</span> touse</span>
<span id="cb168-11"><a href="programar-ado---files.html#cb168-11" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb168-12"><a href="programar-ado---files.html#cb168-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb168-13"><a href="programar-ado---files.html#cb168-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-14"><a href="programar-ado---files.html#cb168-14" aria-hidden="true" tabindex="-1"></a>* Equivale a: </span>
<span id="cb168-15"><a href="programar-ado---files.html#cb168-15" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> myprog</span>
<span id="cb168-16"><a href="programar-ado---files.html#cb168-16" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 17.0</span>
<span id="cb168-17"><a href="programar-ado---files.html#cb168-17" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> <span class="kw">varlist</span> [<span class="kw">if</span>] [<span class="kw">in</span>]</span>
<span id="cb168-18"><a href="programar-ado---files.html#cb168-18" aria-hidden="true" tabindex="-1"></a><span class="kw">tempvar</span> touse</span>
<span id="cb168-19"><a href="programar-ado---files.html#cb168-19" aria-hidden="true" tabindex="-1"></a>mark <span class="ot">`touse&#39;</span> <span class="ot">`if&#39;</span> <span class="ot">`in&#39;</span></span>
<span id="cb168-20"><a href="programar-ado---files.html#cb168-20" aria-hidden="true" tabindex="-1"></a><span class="kw">markout</span> <span class="ot">`touse&#39;</span> <span class="ot">`varlist&#39;</span></span>
<span id="cb168-21"><a href="programar-ado---files.html#cb168-21" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb168-22"><a href="programar-ado---files.html#cb168-22" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p><code>markout</code> también puede ser usado con <code>marksample</code>:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb169-1"><a href="programar-ado---files.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> ...</span>
<span id="cb169-2"><a href="programar-ado---files.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> ... [, Denom(varname) ... ]</span>
<span id="cb169-3"><a href="programar-ado---files.html#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="kw">marksample</span> touse</span>
<span id="cb169-4"><a href="programar-ado---files.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="kw">markout</span> <span class="ot">`touse&#39;</span> <span class="ot">`denom&#39;</span></span>
<span id="cb169-5"><a href="programar-ado---files.html#cb169-5" aria-hidden="true" tabindex="-1"></a>rest <span class="kw">of</span> code ... <span class="kw">if</span> <span class="ot">`touse&#39;</span></span>
<span id="cb169-6"><a href="programar-ado---files.html#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p>Ejemplo Marksample y Markout:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb170-1"><a href="programar-ado---files.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="kw">program</span> cwsumm</span>
<span id="cb170-2"><a href="programar-ado---files.html#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="kw">syntax</span> [<span class="kw">varlist</span>(fv ts)] [<span class="kw">if</span>] [<span class="kw">in</span>] [<span class="kw">aweight</span> <span class="kw">fweight</span>] [, Detail noFormat]</span>
<span id="cb170-3"><a href="programar-ado---files.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="kw">marksample</span> touse</span>
<span id="cb170-4"><a href="programar-ado---files.html#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="kw">summarize</span> <span class="ot">`varlist&#39;</span> [<span class="ot">`weight&#39;`exp&#39;</span>] <span class="kw">if</span> <span class="ot">`touse&#39;</span>, <span class="ot">`detail&#39;</span> <span class="ot">`format&#39;</span></span>
<span id="cb170-5"><a href="programar-ado---files.html#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
</div>
<div id="sortpreserve" class="section level3 hasAnchor" number="4.0.25">
<h3><span class="header-section-number">4.0.25</span> Sortpreserve<a href="programar-ado---files.html#sortpreserve" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Si está escribiendo un programa de Stata que cambia temporalmente el orden de los datos y quieres que los datos se ordenen en su orden original al final de la ejecución, puede ahorrar un poco de programación incluyendo <code>sortpreserve</code>. Para ellos debemos escribir: <code>program miprograma, sortpreserve</code>. Stata automáticamente reordenara las variables como estaban originalmente. Al agregar esta opción se genera una variable temporal llamada <code>_sortindex</code> la que contiene el orden original de los datos.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="programar-do---files.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exportar-información.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ncamposbijit/ncamposbijit/Analisis-de-Datos-Stata-nivel-avanzado/edit/main/01-cursoStata.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ncamposbijit/ncamposbijit/Analisis-de-Datos-Stata-nivel-avanzado/blob/main/01-cursoStata.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
